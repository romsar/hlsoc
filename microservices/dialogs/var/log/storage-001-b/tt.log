Watchdog 2024/06/03 23:42:00 (INFO): using "/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/instances.enabled/dialogs/config.yaml" cluster config for instance "storage-001-b"
started
2024-06-03 23:42:00.339 [58348] main/104/interactive I> Tarantool 3.1.0-0-g96f6d88 Darwin-x86_64-Release
2024-06-03 23:42:00.340 [58348] main/104/interactive I> log level 5 (INFO)
2024-06-03 23:42:00.341 [58348] main/104/interactive I> wal/engine cleanup is paused
2024-06-03 23:42:00.341 [58348] main/104/interactive I> mapping 268435456 bytes for memtx tuple arena...
2024-06-03 23:42:00.341 [58348] main/104/interactive I> Actual slab_alloc_factor calculated on the basis of desired slab_alloc_factor = 1.044274
2024-06-03 23:42:00.341 [58348] main/104/interactive I> mapping 134217728 bytes for vinyl tuple arena...
2024-06-03 23:42:00.343 [58348] main/104/interactive I> update replication_synchro_quorum = 1
2024-06-03 23:42:00.343 [58348] main/104/interactive I> instance uuid 7411d451-49e1-4373-9fed-0a2c2a7b10a8
2024-06-03 23:42:00.344 [58348] main/104/interactive I> tx_binary: bound to [::1]:3302
2024-06-03 23:42:00.344 [58348] main/104/interactive I> connecting to 2 replicas
2024-06-03 23:42:00.345 [58348] main/113/applier/replicator@localhost:3302 I> remote master 7411d451-49e1-4373-9fed-0a2c2a7b10a8 at [::1]:3302 running Tarantool 3.1.0
2024-06-03 23:42:00.345 [58348] main/112/applier/replicator@localhost:3301 I> remote master 33425648-d2aa-4911-9c90-dd6ec549d048 at [::1]:3301 running Tarantool 3.1.0
2024-06-03 23:42:00.346 [58348] main/104/interactive I> connected to 2 replicas
2024-06-03 23:42:00.347 [58348] main/112/applier/replicator@localhost:3301 I> failed to authenticate
2024-06-03 23:42:00.347 [58348] main/112/applier/replicator@localhost:3301 box.cc:4283 E> ER_LOADING: Instance bootstrap hasn't finished yet
2024-06-03 23:42:00.347 [58348] main/112/applier/replicator@localhost:3301 I> will retry every 1.00 second
2024-06-03 23:42:01.350 [58348] main/112/applier/replicator@localhost:3301 I> authenticated
2024-06-03 23:42:01.350 [58348] main/104/interactive I> bootstrapping replica from 33425648-d2aa-4911-9c90-dd6ec549d048 at [::1]:3301
2024-06-03 23:42:01.351 [58348] main/112/applier/replicator@localhost:3301 I> replicaset name: storage-001
2024-06-03 23:42:01.351 [58348] main/112/applier/replicator@localhost:3301 I> replicaset uuid c903494a-bc47-40f2-9266-58472b3f5734
2024-06-03 23:42:01.373 [58348] main/112/applier/replicator@localhost:3301 I> assigned id 1 to replica 33425648-d2aa-4911-9c90-dd6ec549d048
2024-06-03 23:42:01.373 [58348] main/112/applier/replicator@localhost:3301 I> update replication_synchro_quorum = 1
2024-06-03 23:42:01.373 [58348] main/112/applier/replicator@localhost:3301 I> assigned name storage-001-a to replica 33425648-d2aa-4911-9c90-dd6ec549d048
2024-06-03 23:42:01.373 [58348] main/112/applier/replicator@localhost:3301 I> initial data received
2024-06-03 23:42:01.373 [58348] main/112/applier/replicator@localhost:3301 I> assigned id 2 to replica 7411d451-49e1-4373-9fed-0a2c2a7b10a8
2024-06-03 23:42:01.373 [58348] main/112/applier/replicator@localhost:3301 I> update replication_synchro_quorum = 2
2024-06-03 23:42:01.373 [58348] main/112/applier/replicator@localhost:3301 I> RAFT: fencing paused
2024-06-03 23:42:01.373 [58348] main/112/applier/replicator@localhost:3301 I> assigned name storage-001-b to replica 7411d451-49e1-4373-9fed-0a2c2a7b10a8
2024-06-03 23:42:01.373 [58348] main/112/applier/replicator@localhost:3301 I> final data received
2024-06-03 23:42:01.374 [58348] snapshot/101/main I> saving snapshot `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/instances.enabled/dialogs/var/lib/storage-001-b/00000000000000000064.snap.inprogress'
2024-06-03 23:42:01.375 [58348] snapshot/101/main I> done
2024-06-03 23:42:01.375 [58348] main/104/interactive I> ready to accept requests
2024-06-03 23:42:01.375 [58348] main/104/interactive I> synchronizing with 2 replicas
2024-06-03 23:42:01.375 [58348] main/112/applier/replicator@localhost:3301 I> subscribed
2024-06-03 23:42:01.375 [58348] main/112/applier/replicator@localhost:3301 I> remote vclock {1: 64} local vclock {1: 64}
2024-06-03 23:42:01.375 [58348] main/104/interactive C> failed to synchronize with 1 out of 2 replicas
2024-06-03 23:42:01.375 [58348] main/104/interactive I> entering orphan mode
2024-06-03 23:42:01.375 [58348] main/104/interactive/box.load_cfg I> set 'instance_name' configuration option to "storage-001-b"
2024-06-03 23:42:01.375 [58348] main/104/interactive/box.load_cfg I> set 'custom_proc_title' configuration option to "tarantool - storage-001-b"
2024-06-03 23:42:01.375 [58348] main/104/interactive/box.load_cfg I> set 'log_nonblock' configuration option to false
2024-06-03 23:42:01.375 [58348] main/104/interactive/box.load_cfg I> set 'replication' configuration option to ["replicator@localhost:3301","replicator@localhost:3302"]
2024-06-03 23:42:01.375 [58348] main/104/interactive/box.load_cfg I> set 'replicaset_name' configuration option to "storage-001"
2024-06-03 23:42:01.375 [58348] main/104/interactive/box.load_cfg I> set 'listen' configuration option to [{"uri":"localhost:3302"}]
2024-06-03 23:42:01.375 [58348] main/107/checkpoint_daemon I> scheduled next checkpoint for Tue Jun  4 00:51:58 2024
2024-06-03 23:42:01.376 [58348] main/112/applier/replicator@localhost:3301 I> RAFT: message {term: 1, state: follower} from 1
2024-06-03 23:42:01.376 [58348] main/104/interactive/box.load_cfg I> set 'metrics' configuration option to {"labels":{"alias":"storage-001-b"},"include":["all"],"exclude":[]}
2024-06-03 23:42:01.376 [58348] main/104/interactive/box.load_cfg I> set 'read_only' configuration option to true
2024-06-03 23:42:01.376 [58348] main/112/applier/replicator@localhost:3301 I> leaving orphan mode
2024-06-03 23:42:01.403 [58348] main/120/console/unix/: sio.c:315 !> getpeername: Invalid argument
2024-06-03 23:42:01.403 [58348] main/104/interactive I> update replication_synchro_quorum = 2
2024-06-03 23:42:01.404 [58348] main/107/checkpoint_daemon I> scheduled next checkpoint for Tue Jun  4 01:18:15 2024
2024-06-03 23:42:01.439 [58348] main/104/interactive/tarantool.config I> sharding: apply storage config
2024-06-03 23:42:01.439 [58348] main/104/interactive/vshard.storage I> Starting configuration of replica storage-001-b
2024-06-03 23:42:01.439 [58348] main/104/interactive/vshard.storage I> Box configuration was skipped due to the 'manual' box_cfg_mode
2024-06-03 23:42:01.439 [58348] main/125/vshard.state_watch/vshard.util I> instance_watch_f has been started
2024-06-03 23:42:01.439 [58348] main/127/vshard.conn_man/vshard.util I> conn_manager_f has been started
2024-06-03 23:42:01.450 [58348] main I> entering the event loop
2024-06-03 23:42:02.378 [58348] main/111/main I> subscribed replica 33425648-d2aa-4911-9c90-dd6ec549d048 at fd 28, aka [::1]:3302, peer of [::1]:63930
2024-06-03 23:42:02.378 [58348] main/111/main I> remote vclock {1: 64} local vclock {1: 64}
2024-06-03 23:42:02.378 [58348] main/106/gc I> wal/engine cleanup is resumed
2024-06-03 23:42:06.942 [58348] relay/[::1]:63930/101/main I> recover from `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/instances.enabled/dialogs/var/lib/storage-001-b/00000000000000000064.xlog'
2024-06-03 23:52:54.547 [58348] applier_1/103/writer/replicator@localhost:3301 I> fiber `writer/replicator@localhost:3301' has been cancelled
2024-06-03 23:52:54.547 [58348] applier_1/103/writer/replicator@localhost:3301 I> fiber `writer/replicator@localhost:3301': exiting
2024-06-03 23:52:54.547 [58348] main/112/applier/replicator@localhost:3301 I> can't read row
2024-06-03 23:52:54.547 [58348] main/112/applier/replicator@localhost:3301 coio.c:353 E> SocketError: unexpected EOF when reading from socket, called on fd 24, aka [::1]:63901, peer of [::1]:3301: Broken pipe
2024-06-03 23:52:54.547 [58348] main/112/applier/replicator@localhost:3301 I> will retry every 1.00 second
2024-06-03 23:52:54.548 [58348] relay/[::1]:63930/101/main coio.c:353 E> SocketError: unexpected EOF when reading from socket, called on fd 28, aka [::1]:3302, peer of [::1]:63930: Broken pipe
2024-06-03 23:52:54.548 [58348] relay/[::1]:63930/101/main I> exiting the relay loop
2024-06-03 23:52:54.648 [58348] main C> got signal 2 - Interrupt: 2
2024-06-03 23:52:54.648 [58348] main/129/iproto.shutdown I> tx_binary: stopped
2024-06-03 23:52:54.649 [58348] main/103/on_shutdown I> leaving orphan mode
Watchdog 2024/06/03 23:52:54 (INFO): the Instance has shutdown.
Watchdog 2024/06/03 23:53:16 (INFO): using "/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/instances.enabled/dialogs/config.yaml" cluster config for instance "storage-001-b"
started
2024-06-03 23:53:16.325 [59753] main/104/interactive I> Tarantool 3.1.0-0-g96f6d88 Darwin-x86_64-Release
2024-06-03 23:53:16.325 [59753] main/104/interactive I> log level 5 (INFO)
2024-06-03 23:53:16.326 [59753] main/104/interactive I> wal/engine cleanup is paused
2024-06-03 23:53:16.326 [59753] main/104/interactive I> mapping 268435456 bytes for memtx tuple arena...
2024-06-03 23:53:16.326 [59753] main/104/interactive I> Actual slab_alloc_factor calculated on the basis of desired slab_alloc_factor = 1.044274
2024-06-03 23:53:16.326 [59753] main/104/interactive I> mapping 134217728 bytes for vinyl tuple arena...
2024-06-03 23:53:16.326 [59753] main/104/interactive/box.upgrade I> Recovering snapshot with schema version 3.1.0
2024-06-03 23:53:16.328 [59753] main/104/interactive I> update replication_synchro_quorum = 1
2024-06-03 23:53:16.328 [59753] main/104/interactive I> instance uuid 7411d451-49e1-4373-9fed-0a2c2a7b10a8
2024-06-03 23:53:16.329 [59753] main/104/interactive I> instance vclock {1: 1066}
2024-06-03 23:53:16.330 [59753] main/104/interactive I> tx_binary: bound to [::1]:3302
2024-06-03 23:53:16.330 [59753] main/104/interactive I> connecting to 2 replicas
2024-06-03 23:53:16.330 [59753] main/112/applier/replicator@localhost:3301 I> can't connect to master
2024-06-03 23:53:16.330 [59753] main/112/applier/replicator@localhost:3301 coio.c:83 E> SocketError: connect, called on fd 26, aka 127.0.0.1:65223: Connection refused
2024-06-03 23:53:16.330 [59753] main/112/applier/replicator@localhost:3301 I> will retry every 1.00 second
2024-06-03 23:53:16.331 [59753] main/113/applier/replicator@localhost:3302 I> remote master 7411d451-49e1-4373-9fed-0a2c2a7b10a8 at [::1]:3302 running Tarantool 3.1.0
2024-06-03 23:53:17.331 [59753] main/112/applier/replicator@localhost:3301 I> remote master 33425648-d2aa-4911-9c90-dd6ec549d048 at [::1]:3301 running Tarantool 3.1.0
2024-06-03 23:53:17.332 [59753] main/104/interactive I> connected to 2 replicas
2024-06-03 23:53:17.333 [59753] main/104/interactive I> recovery start
2024-06-03 23:53:17.333 [59753] main/104/interactive I> recovering from `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/instances.enabled/dialogs/var/lib/storage-001-b/00000000000000000064.snap'
2024-06-03 23:53:17.333 [59753] main/104/interactive I> replicaset name: storage-001
2024-06-03 23:53:17.333 [59753] main/104/interactive I> replicaset uuid c903494a-bc47-40f2-9266-58472b3f5734
2024-06-03 23:53:17.355 [59753] main/104/interactive I> assigned id 1 to replica 33425648-d2aa-4911-9c90-dd6ec549d048
2024-06-03 23:53:17.356 [59753] main/104/interactive I> update replication_synchro_quorum = 1
2024-06-03 23:53:17.356 [59753] main/104/interactive I> assigned name storage-001-a to replica 33425648-d2aa-4911-9c90-dd6ec549d048
2024-06-03 23:53:17.356 [59753] main/104/interactive I> assigned id 2 to replica 7411d451-49e1-4373-9fed-0a2c2a7b10a8
2024-06-03 23:53:17.356 [59753] main/104/interactive I> update replication_synchro_quorum = 2
2024-06-03 23:53:17.356 [59753] main/104/interactive I> RAFT: fencing paused
2024-06-03 23:53:17.356 [59753] main/104/interactive I> assigned name storage-001-b to replica 7411d451-49e1-4373-9fed-0a2c2a7b10a8
2024-06-03 23:53:17.356 [59753] main/104/interactive I> recover from `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/instances.enabled/dialogs/var/lib/storage-001-b/00000000000000000064.xlog'
2024-06-03 23:53:17.357 [59753] main/104/interactive I> done `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/instances.enabled/dialogs/var/lib/storage-001-b/00000000000000000064.xlog'
2024-06-03 23:53:17.357 [59753] main/104/interactive I> recover from `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/instances.enabled/dialogs/var/lib/storage-001-b/00000000000000001066.xlog'
2024-06-03 23:53:17.357 [59753] main/104/interactive I> done `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/instances.enabled/dialogs/var/lib/storage-001-b/00000000000000001066.xlog'
2024-06-03 23:53:17.357 [59753] main/104/interactive I> Building secondary indexes in space '_bucket'...
2024-06-03 23:53:17.357 [59753] main/104/interactive I> Adding 500 keys to TREE index 'status' ...
2024-06-03 23:53:17.357 [59753] main/104/interactive I> Space '_bucket': done
2024-06-03 23:53:17.357 [59753] main/104/interactive I> Building secondary indexes in space 'messages'...
2024-06-03 23:53:17.357 [59753] main/104/interactive I> Adding 2 keys to TREE index 'bucket_id' ...
2024-06-03 23:53:17.357 [59753] main/104/interactive I> Adding 2 keys to TREE index 'dialog_hash' ...
2024-06-03 23:53:17.357 [59753] main/104/interactive I> Space 'messages': done
2024-06-03 23:53:17.357 [59753] main/104/interactive I> ready to accept requests
2024-06-03 23:53:17.357 [59753] main/104/interactive I> synchronizing with 2 replicas
2024-06-03 23:53:17.358 [59753] main/104/interactive C> failed to synchronize with 1 out of 2 replicas
2024-06-03 23:53:17.358 [59753] main/104/interactive I> entering orphan mode
2024-06-03 23:53:17.358 [59753] main/104/interactive/box.load_cfg I> set 'instance_name' configuration option to "storage-001-b"
2024-06-03 23:53:17.358 [59753] main/104/interactive/box.load_cfg I> set 'custom_proc_title' configuration option to "tarantool - storage-001-b"
2024-06-03 23:53:17.358 [59753] main/104/interactive/box.load_cfg I> set 'log_nonblock' configuration option to false
2024-06-03 23:53:17.358 [59753] main/104/interactive/box.load_cfg I> set 'replication' configuration option to ["replicator@localhost:3301","replicator@localhost:3302"]
2024-06-03 23:53:17.358 [59753] main/104/interactive/box.load_cfg I> set 'replicaset_name' configuration option to "storage-001"
2024-06-03 23:53:17.358 [59753] main/104/interactive/box.load_cfg I> set 'listen' configuration option to [{"uri":"localhost:3302"}]
2024-06-03 23:53:17.358 [59753] main/107/checkpoint_daemon I> scheduled next checkpoint for Tue Jun  4 01:00:42 2024
2024-06-03 23:53:17.358 [59753] main/112/applier/replicator@localhost:3301 I> authenticated
2024-06-03 23:53:17.358 [59753] main/112/applier/replicator@localhost:3301 I> subscribed
2024-06-03 23:53:17.358 [59753] main/112/applier/replicator@localhost:3301 I> remote vclock {1: 1066} local vclock {1: 1066}
2024-06-03 23:53:17.358 [59753] main/104/interactive/box.load_cfg I> set 'metrics' configuration option to {"labels":{"alias":"storage-001-b"},"include":["all"],"exclude":[]}
2024-06-03 23:53:17.358 [59753] main/104/interactive/box.load_cfg I> set 'read_only' configuration option to true
2024-06-03 23:53:17.359 [59753] main/112/applier/replicator@localhost:3301 I> RAFT: message {term: 1, state: follower} from 1
2024-06-03 23:53:17.359 [59753] main/112/applier/replicator@localhost:3301 I> leaving orphan mode
2024-06-03 23:53:17.378 [59753] main/111/main I> subscribed replica 33425648-d2aa-4911-9c90-dd6ec549d048 at fd 33, aka [::1]:3302, peer of [::1]:65244
2024-06-03 23:53:17.378 [59753] main/111/main I> remote vclock {1: 1066} local vclock {1: 1066}
2024-06-03 23:53:17.378 [59753] main/106/gc I> wal/engine cleanup is resumed
2024-06-03 23:53:17.378 [59753] relay/[::1]:65244/101/main I> recover from `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/instances.enabled/dialogs/var/lib/storage-001-b/00000000000000001066.xlog'
2024-06-03 23:53:17.379 [59753] main/120/console/unix/: sio.c:315 !> getpeername: Invalid argument
2024-06-03 23:53:17.379 [59753] main/104/interactive I> update replication_synchro_quorum = 2
2024-06-03 23:53:17.380 [59753] main/107/checkpoint_daemon I> scheduled next checkpoint for Tue Jun  4 01:50:27 2024
2024-06-03 23:53:17.412 [59753] main/104/interactive/tarantool.config I> sharding: apply storage config
2024-06-03 23:53:17.412 [59753] main/104/interactive/vshard.storage I> Starting configuration of replica storage-001-b
2024-06-03 23:53:17.412 [59753] main/104/interactive/vshard.storage I> Box configuration was skipped due to the 'manual' box_cfg_mode
2024-06-03 23:53:17.412 [59753] main/125/vshard.state_watch/vshard.util I> instance_watch_f has been started
2024-06-03 23:53:17.412 [59753] main/127/vshard.conn_man/vshard.util I> conn_manager_f has been started
2024-06-03 23:53:17.416 [59753] main I> entering the event loop
2024-06-03 23:56:46.260 [59753] main C> got signal 2 - Interrupt: 2
2024-06-03 23:56:46.260 [59753] main/128/iproto.shutdown I> tx_binary: stopped
2024-06-03 23:56:46.261 [59753] relay/[::1]:65244/101/main I> fiber `main' has been cancelled
2024-06-03 23:56:46.261 [59753] relay/[::1]:65244/101/main I> fiber `main': exiting
2024-06-03 23:56:46.261 [59753] relay/[::1]:65244/101/main I> exiting the relay loop
2024-06-03 23:56:46.262 [59753] applier_1/103/writer/replicator@localhost:3301 I> fiber `writer/replicator@localhost:3301' has been cancelled
2024-06-03 23:56:46.262 [59753] applier_1/103/writer/replicator@localhost:3301 I> fiber `writer/replicator@localhost:3301': exiting
Watchdog 2024/06/03 23:56:46 (INFO): the Instance has shutdown.
Watchdog 2024/06/03 23:56:52 (INFO): using "/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/instances.enabled/dialogs/config.yaml" cluster config for instance "storage-001-b"
started
2024-06-03 23:56:52.773 [60036] main/104/interactive I> Tarantool 3.1.0-0-g96f6d88 Darwin-x86_64-Release
2024-06-03 23:56:52.774 [60036] main/104/interactive I> log level 5 (INFO)
2024-06-03 23:56:52.774 [60036] main/104/interactive I> wal/engine cleanup is paused
2024-06-03 23:56:52.774 [60036] main/104/interactive I> mapping 268435456 bytes for memtx tuple arena...
2024-06-03 23:56:52.774 [60036] main/104/interactive I> Actual slab_alloc_factor calculated on the basis of desired slab_alloc_factor = 1.044274
2024-06-03 23:56:52.774 [60036] main/104/interactive I> mapping 134217728 bytes for vinyl tuple arena...
2024-06-03 23:56:52.774 [60036] main/104/interactive/box.upgrade I> Recovering snapshot with schema version 3.1.0
2024-06-03 23:56:52.776 [60036] main/104/interactive I> update replication_synchro_quorum = 1
2024-06-03 23:56:52.776 [60036] main/104/interactive I> instance uuid 7411d451-49e1-4373-9fed-0a2c2a7b10a8
2024-06-03 23:56:52.776 [60036] main/104/interactive I> instance vclock {1: 1066}
2024-06-03 23:56:52.777 [60036] main/104/interactive I> tx_binary: bound to [::1]:3302
2024-06-03 23:56:52.778 [60036] main/104/interactive I> connecting to 2 replicas
2024-06-03 23:56:52.779 [60036] main/113/applier/replicator@localhost:3302 I> remote master 7411d451-49e1-4373-9fed-0a2c2a7b10a8 at [::1]:3302 running Tarantool 3.1.0
2024-06-03 23:56:52.779 [60036] main/112/applier/replicator@localhost:3301 I> remote master 33425648-d2aa-4911-9c90-dd6ec549d048 at [::1]:3301 running Tarantool 3.1.0
2024-06-03 23:56:52.780 [60036] main/104/interactive I> connected to 2 replicas
2024-06-03 23:56:52.780 [60036] main/104/interactive I> recovery start
2024-06-03 23:56:52.780 [60036] main/104/interactive I> recovering from `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/instances.enabled/dialogs/var/lib/storage-001-b/00000000000000000064.snap'
2024-06-03 23:56:52.781 [60036] main/104/interactive I> replicaset name: storage-001
2024-06-03 23:56:52.781 [60036] main/104/interactive I> replicaset uuid c903494a-bc47-40f2-9266-58472b3f5734
2024-06-03 23:56:52.800 [60036] main/104/interactive I> assigned id 1 to replica 33425648-d2aa-4911-9c90-dd6ec549d048
2024-06-03 23:56:52.800 [60036] main/104/interactive I> update replication_synchro_quorum = 1
2024-06-03 23:56:52.800 [60036] main/104/interactive I> assigned name storage-001-a to replica 33425648-d2aa-4911-9c90-dd6ec549d048
2024-06-03 23:56:52.800 [60036] main/104/interactive I> assigned id 2 to replica 7411d451-49e1-4373-9fed-0a2c2a7b10a8
2024-06-03 23:56:52.800 [60036] main/104/interactive I> update replication_synchro_quorum = 2
2024-06-03 23:56:52.800 [60036] main/104/interactive I> RAFT: fencing paused
2024-06-03 23:56:52.800 [60036] main/104/interactive I> assigned name storage-001-b to replica 7411d451-49e1-4373-9fed-0a2c2a7b10a8
2024-06-03 23:56:52.800 [60036] main/104/interactive I> recover from `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/instances.enabled/dialogs/var/lib/storage-001-b/00000000000000000064.xlog'
2024-06-03 23:56:52.801 [60036] main/104/interactive I> done `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/instances.enabled/dialogs/var/lib/storage-001-b/00000000000000000064.xlog'
2024-06-03 23:56:52.801 [60036] main/104/interactive I> recover from `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/instances.enabled/dialogs/var/lib/storage-001-b/00000000000000001066.xlog'
2024-06-03 23:56:52.801 [60036] main/104/interactive I> done `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/instances.enabled/dialogs/var/lib/storage-001-b/00000000000000001066.xlog'
2024-06-03 23:56:52.801 [60036] main/104/interactive I> Building secondary indexes in space '_bucket'...
2024-06-03 23:56:52.801 [60036] main/104/interactive I> Adding 500 keys to TREE index 'status' ...
2024-06-03 23:56:52.801 [60036] main/104/interactive I> Space '_bucket': done
2024-06-03 23:56:52.801 [60036] main/104/interactive I> Building secondary indexes in space 'messages'...
2024-06-03 23:56:52.801 [60036] main/104/interactive I> Adding 2 keys to TREE index 'bucket_id' ...
2024-06-03 23:56:52.801 [60036] main/104/interactive I> Adding 2 keys to TREE index 'dialog_hash' ...
2024-06-03 23:56:52.801 [60036] main/104/interactive I> Space 'messages': done
2024-06-03 23:56:52.802 [60036] main/104/interactive I> ready to accept requests
2024-06-03 23:56:52.802 [60036] main/104/interactive I> synchronizing with 2 replicas
2024-06-03 23:56:52.802 [60036] main/104/interactive C> failed to synchronize with 1 out of 2 replicas
2024-06-03 23:56:52.802 [60036] main/104/interactive I> entering orphan mode
2024-06-03 23:56:52.802 [60036] main/104/interactive/box.load_cfg I> set 'instance_name' configuration option to "storage-001-b"
2024-06-03 23:56:52.802 [60036] main/104/interactive/box.load_cfg I> set 'custom_proc_title' configuration option to "tarantool - storage-001-b"
2024-06-03 23:56:52.802 [60036] main/104/interactive/box.load_cfg I> set 'log_nonblock' configuration option to false
2024-06-03 23:56:52.802 [60036] main/104/interactive/box.load_cfg I> set 'replication' configuration option to ["replicator@localhost:3301","replicator@localhost:3302"]
2024-06-03 23:56:52.802 [60036] main/104/interactive/box.load_cfg I> set 'replicaset_name' configuration option to "storage-001"
2024-06-03 23:56:52.802 [60036] main/104/interactive/box.load_cfg I> set 'listen' configuration option to [{"uri":"localhost:3302"}]
2024-06-03 23:56:52.802 [60036] main/107/checkpoint_daemon I> scheduled next checkpoint for Tue Jun  4 01:06:54 2024
2024-06-03 23:56:52.802 [60036] main/112/applier/replicator@localhost:3301 I> authenticated
2024-06-03 23:56:52.802 [60036] main/111/main I> subscribed replica 33425648-d2aa-4911-9c90-dd6ec549d048 at fd 27, aka [::1]:3302, peer of [::1]:65406
2024-06-03 23:56:52.802 [60036] main/111/main I> remote vclock {1: 1066} local vclock {1: 1066}
2024-06-03 23:56:52.802 [60036] main/106/gc I> wal/engine cleanup is resumed
2024-06-03 23:56:52.802 [60036] main/104/interactive/box.load_cfg I> set 'metrics' configuration option to {"labels":{"alias":"storage-001-b"},"include":["all"],"exclude":[]}
2024-06-03 23:56:52.802 [60036] main/104/interactive/box.load_cfg I> set 'read_only' configuration option to true
2024-06-03 23:56:52.803 [60036] main/112/applier/replicator@localhost:3301 I> subscribed
2024-06-03 23:56:52.803 [60036] main/112/applier/replicator@localhost:3301 I> remote vclock {1: 1066} local vclock {1: 1066}
2024-06-03 23:56:52.803 [60036] main/112/applier/replicator@localhost:3301 I> RAFT: message {term: 1, state: follower} from 1
2024-06-03 23:56:52.803 [60036] relay/[::1]:65406/101/main I> recover from `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/instances.enabled/dialogs/var/lib/storage-001-b/00000000000000001066.xlog'
2024-06-03 23:56:52.820 [60036] main/112/applier/replicator@localhost:3301 I> leaving orphan mode
2024-06-03 23:56:52.821 [60036] main/120/console/unix/: sio.c:315 !> getpeername: Invalid argument
2024-06-03 23:56:52.822 [60036] main/104/interactive I> update replication_synchro_quorum = 2
2024-06-03 23:56:52.823 [60036] main/107/checkpoint_daemon I> scheduled next checkpoint for Tue Jun  4 01:44:06 2024
2024-06-03 23:56:52.860 [60036] main/104/interactive/tarantool.config I> sharding: apply storage config
2024-06-03 23:56:52.860 [60036] main/104/interactive/vshard.storage I> Starting configuration of replica storage-001-b
2024-06-03 23:56:52.860 [60036] main/104/interactive/vshard.storage I> Box configuration was skipped due to the 'manual' box_cfg_mode
2024-06-03 23:56:52.861 [60036] main/125/vshard.state_watch/vshard.util I> instance_watch_f has been started
2024-06-03 23:56:52.861 [60036] main/127/vshard.conn_man/vshard.util I> conn_manager_f has been started
2024-06-03 23:56:52.866 [60036] main I> entering the event loop
2024-06-04 00:00:22.949 [60036] applier_1/103/writer/replicator@localhost:3301 I> fiber `writer/replicator@localhost:3301' has been cancelled
2024-06-04 00:00:22.949 [60036] applier_1/103/writer/replicator@localhost:3301 I> fiber `writer/replicator@localhost:3301': exiting
2024-06-04 00:00:22.949 [60036] main/112/applier/replicator@localhost:3301 I> can't read row
2024-06-04 00:00:22.949 [60036] main/112/applier/replicator@localhost:3301 coio.c:353 E> SocketError: unexpected EOF when reading from socket, called on fd 28, aka [::1]:65408, peer of [::1]:3301: Broken pipe
2024-06-04 00:00:22.949 [60036] main/112/applier/replicator@localhost:3301 I> will retry every 1.00 second
2024-06-04 00:00:22.951 [60036] relay/[::1]:65406/101/main coio.c:353 E> SocketError: unexpected EOF when reading from socket, called on fd 27, aka [::1]:3302, peer of [::1]:65406: Broken pipe
2024-06-04 00:00:22.951 [60036] relay/[::1]:65406/101/main I> exiting the relay loop
2024-06-04 00:00:23.051 [60036] main C> got signal 2 - Interrupt: 2
2024-06-04 00:00:23.051 [60036] main/128/iproto.shutdown I> tx_binary: stopped
2024-06-04 00:00:23.052 [60036] main/103/on_shutdown I> leaving orphan mode
Watchdog 2024/06/04 00:00:23 (INFO): the Instance has shutdown.
Watchdog 2024/06/04 00:00:30 (INFO): using "/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/instances.enabled/dialogs/config.yaml" cluster config for instance "storage-001-b"
started
2024-06-04 00:00:31.139 [60308] main/104/interactive I> Tarantool 3.1.0-0-g96f6d88 Darwin-x86_64-Release
2024-06-04 00:00:31.139 [60308] main/104/interactive I> log level 5 (INFO)
2024-06-04 00:00:31.139 [60308] main/104/interactive I> wal/engine cleanup is paused
2024-06-04 00:00:31.140 [60308] main/104/interactive I> mapping 268435456 bytes for memtx tuple arena...
2024-06-04 00:00:31.140 [60308] main/104/interactive I> Actual slab_alloc_factor calculated on the basis of desired slab_alloc_factor = 1.044274
2024-06-04 00:00:31.140 [60308] main/104/interactive I> mapping 134217728 bytes for vinyl tuple arena...
2024-06-04 00:00:31.140 [60308] main/104/interactive/box.upgrade I> Recovering snapshot with schema version 3.1.0
2024-06-04 00:00:31.141 [60308] main/104/interactive I> update replication_synchro_quorum = 1
2024-06-04 00:00:31.142 [60308] main/104/interactive I> instance uuid 7411d451-49e1-4373-9fed-0a2c2a7b10a8
2024-06-04 00:00:31.142 [60308] main/104/interactive I> instance vclock {1: 1066}
2024-06-04 00:00:31.143 [60308] main/104/interactive I> tx_binary: bound to [::1]:3302
2024-06-04 00:00:31.143 [60308] main/104/interactive I> connecting to 2 replicas
2024-06-04 00:00:31.146 [60308] main/112/applier/replicator@localhost:3301 I> remote master 33425648-d2aa-4911-9c90-dd6ec549d048 at [::1]:3301 running Tarantool 3.1.0
2024-06-04 00:00:31.146 [60308] main/113/applier/replicator@localhost:3302 I> remote master 7411d451-49e1-4373-9fed-0a2c2a7b10a8 at [::1]:3302 running Tarantool 3.1.0
2024-06-04 00:00:31.148 [60308] main/104/interactive I> connected to 2 replicas
2024-06-04 00:00:31.148 [60308] main/104/interactive I> recovery start
2024-06-04 00:00:31.148 [60308] main/104/interactive I> recovering from `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/instances.enabled/dialogs/var/lib/storage-001-b/00000000000000000064.snap'
2024-06-04 00:00:31.149 [60308] main/104/interactive I> replicaset name: storage-001
2024-06-04 00:00:31.149 [60308] main/104/interactive I> replicaset uuid c903494a-bc47-40f2-9266-58472b3f5734
2024-06-04 00:00:31.168 [60308] main/104/interactive I> assigned id 1 to replica 33425648-d2aa-4911-9c90-dd6ec549d048
2024-06-04 00:00:31.168 [60308] main/104/interactive I> update replication_synchro_quorum = 1
2024-06-04 00:00:31.168 [60308] main/104/interactive I> assigned name storage-001-a to replica 33425648-d2aa-4911-9c90-dd6ec549d048
2024-06-04 00:00:31.168 [60308] main/104/interactive I> assigned id 2 to replica 7411d451-49e1-4373-9fed-0a2c2a7b10a8
2024-06-04 00:00:31.168 [60308] main/104/interactive I> update replication_synchro_quorum = 2
2024-06-04 00:00:31.168 [60308] main/104/interactive I> RAFT: fencing paused
2024-06-04 00:00:31.168 [60308] main/104/interactive I> assigned name storage-001-b to replica 7411d451-49e1-4373-9fed-0a2c2a7b10a8
2024-06-04 00:00:31.168 [60308] main/104/interactive I> recover from `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/instances.enabled/dialogs/var/lib/storage-001-b/00000000000000000064.xlog'
2024-06-04 00:00:31.169 [60308] main/104/interactive I> done `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/instances.enabled/dialogs/var/lib/storage-001-b/00000000000000000064.xlog'
2024-06-04 00:00:31.169 [60308] main/104/interactive I> recover from `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/instances.enabled/dialogs/var/lib/storage-001-b/00000000000000001066.xlog'
2024-06-04 00:00:31.169 [60308] main/104/interactive I> done `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/instances.enabled/dialogs/var/lib/storage-001-b/00000000000000001066.xlog'
2024-06-04 00:00:31.169 [60308] main/104/interactive I> Building secondary indexes in space '_bucket'...
2024-06-04 00:00:31.169 [60308] main/104/interactive I> Adding 500 keys to TREE index 'status' ...
2024-06-04 00:00:31.169 [60308] main/104/interactive I> Space '_bucket': done
2024-06-04 00:00:31.169 [60308] main/104/interactive I> Building secondary indexes in space 'messages'...
2024-06-04 00:00:31.169 [60308] main/104/interactive I> Adding 2 keys to TREE index 'bucket_id' ...
2024-06-04 00:00:31.169 [60308] main/104/interactive I> Adding 2 keys to TREE index 'dialog_hash' ...
2024-06-04 00:00:31.169 [60308] main/104/interactive I> Space 'messages': done
2024-06-04 00:00:31.169 [60308] main/104/interactive I> ready to accept requests
2024-06-04 00:00:31.169 [60308] main/104/interactive I> synchronizing with 2 replicas
2024-06-04 00:00:31.170 [60308] main/104/interactive C> failed to synchronize with 1 out of 2 replicas
2024-06-04 00:00:31.170 [60308] main/104/interactive I> entering orphan mode
2024-06-04 00:00:31.170 [60308] main/104/interactive/box.load_cfg I> set 'instance_name' configuration option to "storage-001-b"
2024-06-04 00:00:31.170 [60308] main/104/interactive/box.load_cfg I> set 'custom_proc_title' configuration option to "tarantool - storage-001-b"
2024-06-04 00:00:31.170 [60308] main/104/interactive/box.load_cfg I> set 'log_nonblock' configuration option to false
2024-06-04 00:00:31.170 [60308] main/104/interactive/box.load_cfg I> set 'replication' configuration option to ["replicator@localhost:3301","replicator@localhost:3302"]
2024-06-04 00:00:31.170 [60308] main/104/interactive/box.load_cfg I> set 'replicaset_name' configuration option to "storage-001"
2024-06-04 00:00:31.170 [60308] main/104/interactive/box.load_cfg I> set 'listen' configuration option to [{"uri":"localhost:3302"}]
2024-06-04 00:00:31.170 [60308] main/107/checkpoint_daemon I> scheduled next checkpoint for Tue Jun  4 01:40:40 2024
2024-06-04 00:00:31.170 [60308] main/104/interactive/box.load_cfg I> set 'metrics' configuration option to {"labels":{"alias":"storage-001-b"},"include":["all"],"exclude":[]}
2024-06-04 00:00:31.170 [60308] main/104/interactive/box.load_cfg I> set 'read_only' configuration option to true
2024-06-04 00:00:31.170 [60308] main/112/applier/replicator@localhost:3301 I> authenticated
2024-06-04 00:00:31.191 [60308] main/112/applier/replicator@localhost:3301 I> subscribed
2024-06-04 00:00:31.191 [60308] main/112/applier/replicator@localhost:3301 I> remote vclock {1: 1066} local vclock {1: 1066}
2024-06-04 00:00:31.191 [60308] main/111/main I> subscribed replica 33425648-d2aa-4911-9c90-dd6ec549d048 at fd 27, aka [::1]:3302, peer of [::1]:49281
2024-06-04 00:00:31.191 [60308] main/111/main I> remote vclock {1: 1066} local vclock {1: 1066}
2024-06-04 00:00:31.191 [60308] main/106/gc I> wal/engine cleanup is resumed
2024-06-04 00:00:31.191 [60308] main/112/applier/replicator@localhost:3301 I> RAFT: message {term: 1, state: follower} from 1
2024-06-04 00:00:31.191 [60308] main/112/applier/replicator@localhost:3301 I> leaving orphan mode
2024-06-04 00:00:31.192 [60308] relay/[::1]:49281/101/main I> recover from `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/instances.enabled/dialogs/var/lib/storage-001-b/00000000000000001066.xlog'
2024-06-04 00:00:31.193 [60308] main/120/console/unix/: sio.c:315 !> getpeername: Invalid argument
2024-06-04 00:00:31.193 [60308] main/104/interactive I> update replication_synchro_quorum = 2
2024-06-04 00:00:31.194 [60308] main/107/checkpoint_daemon I> scheduled next checkpoint for Tue Jun  4 01:25:48 2024
2024-06-04 00:00:31.233 [60308] main/104/interactive/tarantool.config I> sharding: apply storage config
2024-06-04 00:00:31.233 [60308] main/104/interactive/vshard.storage I> Starting configuration of replica storage-001-b
2024-06-04 00:00:31.233 [60308] main/104/interactive/vshard.storage I> Box configuration was skipped due to the 'manual' box_cfg_mode
2024-06-04 00:00:31.234 [60308] main/125/vshard.state_watch/vshard.util I> instance_watch_f has been started
2024-06-04 00:00:31.234 [60308] main/127/vshard.conn_man/vshard.util I> conn_manager_f has been started
2024-06-04 00:00:31.240 [60308] main I> entering the event loop
2024-06-04 00:02:03.576 [60308] main C> got signal 2 - Interrupt: 2
2024-06-04 00:02:03.576 [60308] main/128/iproto.shutdown I> tx_binary: stopped
2024-06-04 00:02:03.577 [60308] relay/[::1]:49281/101/main I> fiber `main' has been cancelled
2024-06-04 00:02:03.577 [60308] relay/[::1]:49281/101/main I> fiber `main': exiting
2024-06-04 00:02:03.577 [60308] relay/[::1]:49281/101/main I> exiting the relay loop
2024-06-04 00:02:03.577 [60308] applier_1/103/writer/replicator@localhost:3301 I> fiber `writer/replicator@localhost:3301' has been cancelled
2024-06-04 00:02:03.577 [60308] applier_1/103/writer/replicator@localhost:3301 I> fiber `writer/replicator@localhost:3301': exiting
Watchdog 2024/06/04 00:02:03 (INFO): the Instance has shutdown.
Watchdog 2024/06/04 00:02:10 (INFO): using "/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/instances.enabled/dialogs/config.yaml" cluster config for instance "storage-001-b"
started
2024-06-04 00:02:11.141 [60493] main/104/interactive I> Tarantool 3.1.0-0-g96f6d88 Darwin-x86_64-Release
2024-06-04 00:02:11.141 [60493] main/104/interactive I> log level 5 (INFO)
2024-06-04 00:02:11.141 [60493] main/104/interactive I> wal/engine cleanup is paused
2024-06-04 00:02:11.141 [60493] main/104/interactive I> mapping 268435456 bytes for memtx tuple arena...
2024-06-04 00:02:11.141 [60493] main/104/interactive I> Actual slab_alloc_factor calculated on the basis of desired slab_alloc_factor = 1.044274
2024-06-04 00:02:11.141 [60493] main/104/interactive I> mapping 134217728 bytes for vinyl tuple arena...
2024-06-04 00:02:11.142 [60493] main/104/interactive/box.upgrade I> Recovering snapshot with schema version 3.1.0
2024-06-04 00:02:11.143 [60493] main/104/interactive I> update replication_synchro_quorum = 1
2024-06-04 00:02:11.143 [60493] main/104/interactive I> instance uuid 7411d451-49e1-4373-9fed-0a2c2a7b10a8
2024-06-04 00:02:11.144 [60493] main/104/interactive I> instance vclock {1: 1066}
2024-06-04 00:02:11.145 [60493] main/104/interactive I> tx_binary: bound to [::1]:3302
2024-06-04 00:02:11.145 [60493] main/104/interactive I> connecting to 2 replicas
2024-06-04 00:02:11.145 [60493] main/112/applier/replicator@localhost:3301 I> remote master 33425648-d2aa-4911-9c90-dd6ec549d048 at [::1]:3301 running Tarantool 3.1.0
2024-06-04 00:02:11.146 [60493] main/113/applier/replicator@localhost:3302 I> remote master 7411d451-49e1-4373-9fed-0a2c2a7b10a8 at [::1]:3302 running Tarantool 3.1.0
2024-06-04 00:02:11.147 [60493] main/104/interactive I> connected to 2 replicas
2024-06-04 00:02:11.147 [60493] main/104/interactive I> recovery start
2024-06-04 00:02:11.147 [60493] main/104/interactive I> recovering from `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/instances.enabled/dialogs/var/lib/storage-001-b/00000000000000000064.snap'
2024-06-04 00:02:11.147 [60493] main/104/interactive I> replicaset name: storage-001
2024-06-04 00:02:11.147 [60493] main/104/interactive I> replicaset uuid c903494a-bc47-40f2-9266-58472b3f5734
2024-06-04 00:02:11.166 [60493] main/104/interactive I> assigned id 1 to replica 33425648-d2aa-4911-9c90-dd6ec549d048
2024-06-04 00:02:11.166 [60493] main/104/interactive I> update replication_synchro_quorum = 1
2024-06-04 00:02:11.166 [60493] main/104/interactive I> assigned name storage-001-a to replica 33425648-d2aa-4911-9c90-dd6ec549d048
2024-06-04 00:02:11.166 [60493] main/104/interactive I> assigned id 2 to replica 7411d451-49e1-4373-9fed-0a2c2a7b10a8
2024-06-04 00:02:11.166 [60493] main/104/interactive I> update replication_synchro_quorum = 2
2024-06-04 00:02:11.166 [60493] main/104/interactive I> RAFT: fencing paused
2024-06-04 00:02:11.166 [60493] main/104/interactive I> assigned name storage-001-b to replica 7411d451-49e1-4373-9fed-0a2c2a7b10a8
2024-06-04 00:02:11.166 [60493] main/104/interactive I> recover from `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/instances.enabled/dialogs/var/lib/storage-001-b/00000000000000000064.xlog'
2024-06-04 00:02:11.167 [60493] main/104/interactive I> done `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/instances.enabled/dialogs/var/lib/storage-001-b/00000000000000000064.xlog'
2024-06-04 00:02:11.167 [60493] main/104/interactive I> recover from `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/instances.enabled/dialogs/var/lib/storage-001-b/00000000000000001066.xlog'
2024-06-04 00:02:11.167 [60493] main/104/interactive I> done `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/instances.enabled/dialogs/var/lib/storage-001-b/00000000000000001066.xlog'
2024-06-04 00:02:11.167 [60493] main/104/interactive I> Building secondary indexes in space '_bucket'...
2024-06-04 00:02:11.167 [60493] main/104/interactive I> Adding 500 keys to TREE index 'status' ...
2024-06-04 00:02:11.167 [60493] main/104/interactive I> Space '_bucket': done
2024-06-04 00:02:11.167 [60493] main/104/interactive I> Building secondary indexes in space 'messages'...
2024-06-04 00:02:11.167 [60493] main/104/interactive I> Adding 2 keys to TREE index 'bucket_id' ...
2024-06-04 00:02:11.167 [60493] main/104/interactive I> Adding 2 keys to TREE index 'dialog_hash' ...
2024-06-04 00:02:11.167 [60493] main/104/interactive I> Space 'messages': done
2024-06-04 00:02:11.167 [60493] main/104/interactive I> ready to accept requests
2024-06-04 00:02:11.167 [60493] main/104/interactive I> synchronizing with 2 replicas
2024-06-04 00:02:11.168 [60493] main/104/interactive C> failed to synchronize with 1 out of 2 replicas
2024-06-04 00:02:11.168 [60493] main/104/interactive I> entering orphan mode
2024-06-04 00:02:11.168 [60493] main/112/applier/replicator@localhost:3301 I> failed to authenticate
2024-06-04 00:02:11.168 [60493] main/112/applier/replicator@localhost:3301 box.cc:4283 E> ER_LOADING: Instance bootstrap hasn't finished yet
2024-06-04 00:02:11.168 [60493] main/112/applier/replicator@localhost:3301 I> will retry every 1.00 second
2024-06-04 00:02:11.168 [60493] main/104/interactive/box.load_cfg I> set 'instance_name' configuration option to "storage-001-b"
2024-06-04 00:02:11.168 [60493] main/104/interactive/box.load_cfg I> set 'custom_proc_title' configuration option to "tarantool - storage-001-b"
2024-06-04 00:02:11.168 [60493] main/104/interactive/box.load_cfg I> set 'log_nonblock' configuration option to false
2024-06-04 00:02:11.168 [60493] main/104/interactive/box.load_cfg I> set 'replication' configuration option to ["replicator@localhost:3301","replicator@localhost:3302"]
2024-06-04 00:02:11.168 [60493] main/104/interactive/box.load_cfg I> set 'replicaset_name' configuration option to "storage-001"
2024-06-04 00:02:11.168 [60493] main/104/interactive/box.load_cfg I> set 'listen' configuration option to [{"uri":"localhost:3302"}]
2024-06-04 00:02:11.168 [60493] main/107/checkpoint_daemon I> scheduled next checkpoint for Tue Jun  4 01:50:00 2024
2024-06-04 00:02:11.168 [60493] main/104/interactive/box.load_cfg I> set 'metrics' configuration option to {"labels":{"alias":"storage-001-b"},"include":["all"],"exclude":[]}
2024-06-04 00:02:11.168 [60493] main/104/interactive/box.load_cfg I> set 'read_only' configuration option to true
2024-06-04 00:02:11.187 [60493] main/119/console/unix/: sio.c:315 !> getpeername: Invalid argument
2024-06-04 00:02:11.188 [60493] main/104/interactive I> update replication_synchro_quorum = 2
2024-06-04 00:02:11.188 [60493] main/107/checkpoint_daemon I> scheduled next checkpoint for Tue Jun  4 01:20:34 2024
2024-06-04 00:02:11.218 [60493] main/104/interactive/tarantool.config I> sharding: apply storage config
2024-06-04 00:02:11.219 [60493] main/104/interactive/vshard.storage I> Starting configuration of replica storage-001-b
2024-06-04 00:02:11.219 [60493] main/104/interactive/vshard.storage I> Box configuration was skipped due to the 'manual' box_cfg_mode
2024-06-04 00:02:11.219 [60493] main/124/vshard.state_watch/vshard.util I> instance_watch_f has been started
2024-06-04 00:02:11.219 [60493] main/126/vshard.conn_man/vshard.util I> conn_manager_f has been started
2024-06-04 00:02:11.223 [60493] main I> entering the event loop
2024-06-04 00:02:11.271 [60493] main/111/main I> subscribed replica 33425648-d2aa-4911-9c90-dd6ec549d048 at fd 11, aka [::1]:3302, peer of [::1]:49355
2024-06-04 00:02:11.271 [60493] main/111/main I> remote vclock {1: 1066} local vclock {1: 1066}
2024-06-04 00:02:11.271 [60493] main/106/gc I> wal/engine cleanup is resumed
2024-06-04 00:02:11.271 [60493] relay/[::1]:49355/101/main I> recover from `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/instances.enabled/dialogs/var/lib/storage-001-b/00000000000000001066.xlog'
2024-06-04 00:02:12.169 [60493] main/112/applier/replicator@localhost:3301 I> authenticated
2024-06-04 00:02:12.170 [60493] main/112/applier/replicator@localhost:3301 I> subscribed
2024-06-04 00:02:12.170 [60493] main/112/applier/replicator@localhost:3301 I> remote vclock {1: 1066} local vclock {1: 1066}
2024-06-04 00:02:12.170 [60493] main/112/applier/replicator@localhost:3301 I> RAFT: message {term: 1, state: follower} from 1
2024-06-04 00:02:12.170 [60493] main/112/applier/replicator@localhost:3301 I> leaving orphan mode
2024-06-04 00:02:55.819 [60493] applier_1/103/writer/replicator@localhost:3301 I> fiber `writer/replicator@localhost:3301' has been cancelled
2024-06-04 00:02:55.819 [60493] applier_1/103/writer/replicator@localhost:3301 I> fiber `writer/replicator@localhost:3301': exiting
2024-06-04 00:02:55.819 [60493] main/112/applier/replicator@localhost:3301 I> can't read row
2024-06-04 00:02:55.819 [60493] main/112/applier/replicator@localhost:3301 coio.c:353 E> SocketError: unexpected EOF when reading from socket, called on fd 29, aka [::1]:49385, peer of [::1]:3301: Broken pipe
2024-06-04 00:02:55.819 [60493] main/112/applier/replicator@localhost:3301 I> will retry every 1.00 second
2024-06-04 00:02:55.821 [60493] relay/[::1]:49355/101/main coio.c:353 E> SocketError: unexpected EOF when reading from socket, called on fd 11, aka [::1]:3302, peer of [::1]:49355: Broken pipe
2024-06-04 00:02:55.821 [60493] relay/[::1]:49355/101/main I> exiting the relay loop
2024-06-04 00:02:55.920 [60493] main C> got signal 2 - Interrupt: 2
2024-06-04 00:02:55.920 [60493] main/130/iproto.shutdown I> tx_binary: stopped
2024-06-04 00:02:55.922 [60493] main/103/on_shutdown I> leaving orphan mode
Watchdog 2024/06/04 00:02:55 (INFO): the Instance has shutdown.
Watchdog 2024/06/04 00:03:00 (INFO): using "/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/instances.enabled/dialogs/config.yaml" cluster config for instance "storage-001-b"
started
2024-06-04 00:03:01.046 [60628] main/104/interactive I> Tarantool 3.1.0-0-g96f6d88 Darwin-x86_64-Release
2024-06-04 00:03:01.047 [60628] main/104/interactive I> log level 5 (INFO)
2024-06-04 00:03:01.047 [60628] main/104/interactive I> wal/engine cleanup is paused
2024-06-04 00:03:01.048 [60628] main/104/interactive I> mapping 268435456 bytes for memtx tuple arena...
2024-06-04 00:03:01.048 [60628] main/104/interactive I> Actual slab_alloc_factor calculated on the basis of desired slab_alloc_factor = 1.044274
2024-06-04 00:03:01.048 [60628] main/104/interactive I> mapping 134217728 bytes for vinyl tuple arena...
2024-06-04 00:03:01.049 [60628] main/104/interactive/box.upgrade I> Recovering snapshot with schema version 3.1.0
2024-06-04 00:03:01.054 [60628] main/104/interactive I> update replication_synchro_quorum = 1
2024-06-04 00:03:01.055 [60628] main/104/interactive I> instance uuid 7411d451-49e1-4373-9fed-0a2c2a7b10a8
2024-06-04 00:03:01.056 [60628] main/104/interactive I> instance vclock {1: 1068}
2024-06-04 00:03:01.057 [60628] main/104/interactive I> tx_binary: bound to [::1]:3302
2024-06-04 00:03:01.058 [60628] main/104/interactive I> connecting to 2 replicas
2024-06-04 00:03:01.059 [60628] main/112/applier/replicator@localhost:3301 I> remote master 33425648-d2aa-4911-9c90-dd6ec549d048 at [::1]:3301 running Tarantool 3.1.0
2024-06-04 00:03:01.059 [60628] main/113/applier/replicator@localhost:3302 I> remote master 7411d451-49e1-4373-9fed-0a2c2a7b10a8 at [::1]:3302 running Tarantool 3.1.0
2024-06-04 00:03:01.060 [60628] main/104/interactive I> connected to 2 replicas
2024-06-04 00:03:01.061 [60628] main/104/interactive I> recovery start
2024-06-04 00:03:01.061 [60628] main/104/interactive I> recovering from `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/instances.enabled/dialogs/var/lib/storage-001-b/00000000000000000064.snap'
2024-06-04 00:03:01.061 [60628] main/104/interactive I> replicaset name: storage-001
2024-06-04 00:03:01.061 [60628] main/104/interactive I> replicaset uuid c903494a-bc47-40f2-9266-58472b3f5734
2024-06-04 00:03:01.085 [60628] main/104/interactive I> assigned id 1 to replica 33425648-d2aa-4911-9c90-dd6ec549d048
2024-06-04 00:03:01.085 [60628] main/104/interactive I> update replication_synchro_quorum = 1
2024-06-04 00:03:01.085 [60628] main/104/interactive I> assigned name storage-001-a to replica 33425648-d2aa-4911-9c90-dd6ec549d048
2024-06-04 00:03:01.085 [60628] main/104/interactive I> assigned id 2 to replica 7411d451-49e1-4373-9fed-0a2c2a7b10a8
2024-06-04 00:03:01.086 [60628] main/104/interactive I> update replication_synchro_quorum = 2
2024-06-04 00:03:01.086 [60628] main/104/interactive I> RAFT: fencing paused
2024-06-04 00:03:01.086 [60628] main/104/interactive I> assigned name storage-001-b to replica 7411d451-49e1-4373-9fed-0a2c2a7b10a8
2024-06-04 00:03:01.086 [60628] main/104/interactive I> recover from `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/instances.enabled/dialogs/var/lib/storage-001-b/00000000000000000064.xlog'
2024-06-04 00:03:01.088 [60628] main/104/interactive I> done `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/instances.enabled/dialogs/var/lib/storage-001-b/00000000000000000064.xlog'
2024-06-04 00:03:01.088 [60628] main/104/interactive I> recover from `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/instances.enabled/dialogs/var/lib/storage-001-b/00000000000000001066.xlog'
2024-06-04 00:03:01.088 [60628] main/104/interactive I> done `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/instances.enabled/dialogs/var/lib/storage-001-b/00000000000000001066.xlog'
2024-06-04 00:03:01.088 [60628] main/104/interactive I> recover from `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/instances.enabled/dialogs/var/lib/storage-001-b/00000000000000001068.xlog'
2024-06-04 00:03:01.088 [60628] main/104/interactive I> done `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/instances.enabled/dialogs/var/lib/storage-001-b/00000000000000001068.xlog'
2024-06-04 00:03:01.089 [60628] main/104/interactive I> Building secondary indexes in space '_bucket'...
2024-06-04 00:03:01.089 [60628] main/104/interactive I> Adding 500 keys to TREE index 'status' ...
2024-06-04 00:03:01.089 [60628] main/104/interactive I> Space '_bucket': done
2024-06-04 00:03:01.089 [60628] main/104/interactive I> Building secondary indexes in space 'messages'...
2024-06-04 00:03:01.089 [60628] main/104/interactive I> Adding 4 keys to TREE index 'bucket_id' ...
2024-06-04 00:03:01.089 [60628] main/104/interactive I> Adding 4 keys to TREE index 'dialog_hash' ...
2024-06-04 00:03:01.089 [60628] main/104/interactive I> Space 'messages': done
2024-06-04 00:03:01.089 [60628] main/104/interactive I> ready to accept requests
2024-06-04 00:03:01.089 [60628] main/104/interactive I> synchronizing with 2 replicas
2024-06-04 00:03:01.089 [60628] main/104/interactive C> failed to synchronize with 1 out of 2 replicas
2024-06-04 00:03:01.089 [60628] main/104/interactive I> entering orphan mode
2024-06-04 00:03:01.089 [60628] main/112/applier/replicator@localhost:3301 I> failed to authenticate
2024-06-04 00:03:01.089 [60628] main/112/applier/replicator@localhost:3301 box.cc:4283 E> ER_LOADING: Instance bootstrap hasn't finished yet
2024-06-04 00:03:01.089 [60628] main/112/applier/replicator@localhost:3301 I> will retry every 1.00 second
2024-06-04 00:03:01.089 [60628] main/104/interactive/box.load_cfg I> set 'instance_name' configuration option to "storage-001-b"
2024-06-04 00:03:01.090 [60628] main/104/interactive/box.load_cfg I> set 'custom_proc_title' configuration option to "tarantool - storage-001-b"
2024-06-04 00:03:01.090 [60628] main/104/interactive/box.load_cfg I> set 'log_nonblock' configuration option to false
2024-06-04 00:03:01.090 [60628] main/104/interactive/box.load_cfg I> set 'replication' configuration option to ["replicator@localhost:3301","replicator@localhost:3302"]
2024-06-04 00:03:01.090 [60628] main/104/interactive/box.load_cfg I> set 'replicaset_name' configuration option to "storage-001"
2024-06-04 00:03:01.090 [60628] main/104/interactive/box.load_cfg I> set 'listen' configuration option to [{"uri":"localhost:3302"}]
2024-06-04 00:03:01.090 [60628] main/107/checkpoint_daemon I> scheduled next checkpoint for Tue Jun  4 01:09:11 2024
2024-06-04 00:03:01.090 [60628] main/104/interactive/box.load_cfg I> set 'metrics' configuration option to {"labels":{"alias":"storage-001-b"},"include":["all"],"exclude":[]}
2024-06-04 00:03:01.090 [60628] main/104/interactive/box.load_cfg I> set 'read_only' configuration option to true
2024-06-04 00:03:01.126 [60628] main/119/console/unix/: sio.c:315 !> getpeername: Invalid argument
2024-06-04 00:03:01.127 [60628] main/104/interactive I> update replication_synchro_quorum = 2
2024-06-04 00:03:01.129 [60628] main/107/checkpoint_daemon I> scheduled next checkpoint for Tue Jun  4 01:06:34 2024
2024-06-04 00:03:01.173 [60628] main/104/interactive/tarantool.config I> sharding: apply storage config
2024-06-04 00:03:01.173 [60628] main/104/interactive/vshard.storage I> Starting configuration of replica storage-001-b
2024-06-04 00:03:01.173 [60628] main/104/interactive/vshard.storage I> Box configuration was skipped due to the 'manual' box_cfg_mode
2024-06-04 00:03:01.173 [60628] main/124/vshard.state_watch/vshard.util I> instance_watch_f has been started
2024-06-04 00:03:01.173 [60628] main/126/vshard.conn_man/vshard.util I> conn_manager_f has been started
2024-06-04 00:03:01.178 [60628] main I> entering the event loop
2024-06-04 00:03:02.079 [60628] main/111/main I> subscribed replica 33425648-d2aa-4911-9c90-dd6ec549d048 at fd 13, aka [::1]:3302, peer of [::1]:49436
2024-06-04 00:03:02.079 [60628] main/111/main I> remote vclock {1: 1068} local vclock {1: 1068}
2024-06-04 00:03:02.079 [60628] main/106/gc I> wal/engine cleanup is resumed
2024-06-04 00:03:02.080 [60628] relay/[::1]:49436/101/main I> recover from `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/instances.enabled/dialogs/var/lib/storage-001-b/00000000000000001068.xlog'
2024-06-04 00:03:02.134 [60628] main/112/applier/replicator@localhost:3301 I> authenticated
2024-06-04 00:03:02.135 [60628] main/112/applier/replicator@localhost:3301 I> subscribed
2024-06-04 00:03:02.135 [60628] main/112/applier/replicator@localhost:3301 I> remote vclock {1: 1068} local vclock {1: 1068}
2024-06-04 00:03:02.135 [60628] main/112/applier/replicator@localhost:3301 I> RAFT: message {term: 1, state: follower} from 1
2024-06-04 00:03:02.140 [60628] main/112/applier/replicator@localhost:3301 I> leaving orphan mode
2024-06-04 00:09:10.338 [60628] applier_1/103/writer/replicator@localhost:3301 I> fiber `writer/replicator@localhost:3301' has been cancelled
2024-06-04 00:09:10.338 [60628] applier_1/103/writer/replicator@localhost:3301 I> fiber `writer/replicator@localhost:3301': exiting
2024-06-04 00:09:10.338 [60628] main/112/applier/replicator@localhost:3301 I> can't read row
2024-06-04 00:09:10.338 [60628] main/112/applier/replicator@localhost:3301 coio.c:353 E> SocketError: unexpected EOF when reading from socket, called on fd 28, aka [::1]:49438, peer of [::1]:3301: Broken pipe
2024-06-04 00:09:10.338 [60628] main/112/applier/replicator@localhost:3301 I> will retry every 1.00 second
2024-06-04 00:09:10.340 [60628] relay/[::1]:49436/101/main coio.c:353 E> SocketError: unexpected EOF when reading from socket, called on fd 13, aka [::1]:3302, peer of [::1]:49436: Broken pipe
2024-06-04 00:09:10.340 [60628] relay/[::1]:49436/101/main I> exiting the relay loop
2024-06-04 00:09:10.441 [60628] main C> got signal 2 - Interrupt: 2
2024-06-04 00:09:10.441 [60628] main/130/iproto.shutdown I> tx_binary: stopped
2024-06-04 00:09:10.442 [60628] main/103/on_shutdown I> leaving orphan mode
Watchdog 2024/06/04 00:09:10 (INFO): the Instance has shutdown.
Watchdog 2024/06/04 00:10:18 (INFO): using "/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/config.yaml" cluster config for instance "storage-001-b"
started
2024-06-04 00:10:18.784 [61387] main/104/interactive I> Tarantool 3.1.0-0-g96f6d88 Darwin-x86_64-Release
2024-06-04 00:10:18.784 [61387] main/104/interactive I> log level 5 (INFO)
2024-06-04 00:10:18.785 [61387] main/104/interactive I> wal/engine cleanup is paused
2024-06-04 00:10:18.785 [61387] main/104/interactive I> mapping 268435456 bytes for memtx tuple arena...
2024-06-04 00:10:18.785 [61387] main/104/interactive I> Actual slab_alloc_factor calculated on the basis of desired slab_alloc_factor = 1.044274
2024-06-04 00:10:18.785 [61387] main/104/interactive I> mapping 134217728 bytes for vinyl tuple arena...
2024-06-04 00:10:18.785 [61387] main/104/interactive/box.upgrade I> Recovering snapshot with schema version 3.1.0
2024-06-04 00:10:18.786 [61387] main/104/interactive I> update replication_synchro_quorum = 1
2024-06-04 00:10:18.786 [61387] main/104/interactive I> instance uuid 7411d451-49e1-4373-9fed-0a2c2a7b10a8
2024-06-04 00:10:18.787 [61387] main/104/interactive I> instance vclock {1: 1069}
2024-06-04 00:10:18.788 [61387] main/104/interactive I> tx_binary: bound to [::1]:3302
2024-06-04 00:10:18.788 [61387] main/104/interactive I> connecting to 2 replicas
2024-06-04 00:10:18.789 [61387] main/112/applier/replicator@localhost:3301 I> remote master 33425648-d2aa-4911-9c90-dd6ec549d048 at [::1]:3301 running Tarantool 3.1.0
2024-06-04 00:10:18.789 [61387] main/113/applier/replicator@localhost:3302 I> remote master 7411d451-49e1-4373-9fed-0a2c2a7b10a8 at [::1]:3302 running Tarantool 3.1.0
2024-06-04 00:10:18.790 [61387] main/104/interactive I> connected to 2 replicas
2024-06-04 00:10:18.790 [61387] main/104/interactive I> recovery start
2024-06-04 00:10:18.790 [61387] main/104/interactive I> recovering from `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/var/lib/storage-001-b/00000000000000000064.snap'
2024-06-04 00:10:18.791 [61387] main/104/interactive I> replicaset name: storage-001
2024-06-04 00:10:18.791 [61387] main/104/interactive I> replicaset uuid c903494a-bc47-40f2-9266-58472b3f5734
2024-06-04 00:10:18.808 [61387] main/104/interactive I> assigned id 1 to replica 33425648-d2aa-4911-9c90-dd6ec549d048
2024-06-04 00:10:18.808 [61387] main/104/interactive I> update replication_synchro_quorum = 1
2024-06-04 00:10:18.808 [61387] main/104/interactive I> assigned name storage-001-a to replica 33425648-d2aa-4911-9c90-dd6ec549d048
2024-06-04 00:10:18.809 [61387] main/104/interactive I> assigned id 2 to replica 7411d451-49e1-4373-9fed-0a2c2a7b10a8
2024-06-04 00:10:18.809 [61387] main/104/interactive I> update replication_synchro_quorum = 2
2024-06-04 00:10:18.809 [61387] main/104/interactive I> RAFT: fencing paused
2024-06-04 00:10:18.809 [61387] main/104/interactive I> assigned name storage-001-b to replica 7411d451-49e1-4373-9fed-0a2c2a7b10a8
2024-06-04 00:10:18.809 [61387] main/104/interactive I> recover from `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/var/lib/storage-001-b/00000000000000000064.xlog'
2024-06-04 00:10:18.809 [61387] main/104/interactive I> done `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/var/lib/storage-001-b/00000000000000000064.xlog'
2024-06-04 00:10:18.810 [61387] main/104/interactive I> recover from `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/var/lib/storage-001-b/00000000000000001066.xlog'
2024-06-04 00:10:18.810 [61387] main/104/interactive I> done `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/var/lib/storage-001-b/00000000000000001066.xlog'
2024-06-04 00:10:18.810 [61387] main/104/interactive I> recover from `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/var/lib/storage-001-b/00000000000000001068.xlog'
2024-06-04 00:10:18.810 [61387] main/104/interactive I> done `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/var/lib/storage-001-b/00000000000000001068.xlog'
2024-06-04 00:10:18.810 [61387] main/104/interactive I> recover from `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/var/lib/storage-001-b/00000000000000001069.xlog'
2024-06-04 00:10:18.810 [61387] main/104/interactive I> done `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/var/lib/storage-001-b/00000000000000001069.xlog'
2024-06-04 00:10:18.810 [61387] main/104/interactive I> Building secondary indexes in space '_bucket'...
2024-06-04 00:10:18.810 [61387] main/104/interactive I> Adding 500 keys to TREE index 'status' ...
2024-06-04 00:10:18.810 [61387] main/104/interactive I> Space '_bucket': done
2024-06-04 00:10:18.810 [61387] main/104/interactive I> Building secondary indexes in space 'messages'...
2024-06-04 00:10:18.810 [61387] main/104/interactive I> Adding 5 keys to TREE index 'bucket_id' ...
2024-06-04 00:10:18.810 [61387] main/104/interactive I> Adding 5 keys to TREE index 'dialog_hash' ...
2024-06-04 00:10:18.810 [61387] main/104/interactive I> Space 'messages': done
2024-06-04 00:10:18.811 [61387] main/104/interactive I> ready to accept requests
2024-06-04 00:10:18.811 [61387] main/104/interactive I> synchronizing with 2 replicas
2024-06-04 00:10:18.811 [61387] main/112/applier/replicator@localhost:3301 I> failed to authenticate
2024-06-04 00:10:18.811 [61387] main/112/applier/replicator@localhost:3301 box.cc:4283 E> ER_LOADING: Instance bootstrap hasn't finished yet
2024-06-04 00:10:18.811 [61387] main/112/applier/replicator@localhost:3301 I> will retry every 1.00 second
2024-06-04 00:10:18.811 [61387] main/104/interactive C> failed to synchronize with 1 out of 2 replicas
2024-06-04 00:10:18.811 [61387] main/104/interactive I> entering orphan mode
2024-06-04 00:10:18.811 [61387] main/104/interactive/box.load_cfg I> set 'instance_name' configuration option to "storage-001-b"
2024-06-04 00:10:18.811 [61387] main/104/interactive/box.load_cfg I> set 'custom_proc_title' configuration option to "tarantool - storage-001-b"
2024-06-04 00:10:18.811 [61387] main/104/interactive/box.load_cfg I> set 'log_nonblock' configuration option to false
2024-06-04 00:10:18.811 [61387] main/104/interactive/box.load_cfg I> set 'replication' configuration option to ["replicator@localhost:3301","replicator@localhost:3302"]
2024-06-04 00:10:18.811 [61387] main/104/interactive/box.load_cfg I> set 'replicaset_name' configuration option to "storage-001"
2024-06-04 00:10:18.811 [61387] main/104/interactive/box.load_cfg I> set 'listen' configuration option to [{"uri":"localhost:3302"}]
2024-06-04 00:10:18.811 [61387] main/107/checkpoint_daemon I> scheduled next checkpoint for Tue Jun  4 02:08:02 2024
2024-06-04 00:10:18.811 [61387] main/104/interactive/box.load_cfg I> set 'metrics' configuration option to {"labels":{"alias":"storage-001-b"},"include":["all"],"exclude":[]}
2024-06-04 00:10:18.811 [61387] main/104/interactive/box.load_cfg I> set 'read_only' configuration option to true
2024-06-04 00:10:18.828 [61387] main/119/console/unix/: sio.c:315 !> getpeername: Invalid argument
2024-06-04 00:10:18.829 [61387] main/104/interactive I> update replication_synchro_quorum = 2
2024-06-04 00:10:18.830 [61387] main/107/checkpoint_daemon I> scheduled next checkpoint for Tue Jun  4 01:23:46 2024
2024-06-04 00:10:18.865 [61387] main/104/interactive/tarantool.config I> sharding: apply storage config
2024-06-04 00:10:18.865 [61387] main/104/interactive/vshard.storage I> Starting configuration of replica storage-001-b
2024-06-04 00:10:18.865 [61387] main/104/interactive/vshard.storage I> Box configuration was skipped due to the 'manual' box_cfg_mode
2024-06-04 00:10:18.865 [61387] main/124/vshard.state_watch/vshard.util I> instance_watch_f has been started
2024-06-04 00:10:18.865 [61387] main/126/vshard.conn_man/vshard.util I> conn_manager_f has been started
2024-06-04 00:10:18.874 [61387] main I> entering the event loop
2024-06-04 00:10:19.802 [61387] main/111/main I> subscribed replica 33425648-d2aa-4911-9c90-dd6ec549d048 at fd 13, aka [::1]:3302, peer of [::1]:50409
2024-06-04 00:10:19.802 [61387] main/111/main I> remote vclock {1: 1069} local vclock {1: 1069}
2024-06-04 00:10:19.802 [61387] main/106/gc I> wal/engine cleanup is resumed
2024-06-04 00:10:19.803 [61387] relay/[::1]:50409/101/main I> recover from `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/var/lib/storage-001-b/00000000000000001069.xlog'
2024-06-04 00:10:19.877 [61387] main/112/applier/replicator@localhost:3301 I> authenticated
2024-06-04 00:10:19.877 [61387] main/112/applier/replicator@localhost:3301 I> subscribed
2024-06-04 00:10:19.877 [61387] main/112/applier/replicator@localhost:3301 I> remote vclock {1: 1069} local vclock {1: 1069}
2024-06-04 00:10:19.877 [61387] main/112/applier/replicator@localhost:3301 I> RAFT: message {term: 1, state: follower} from 1
2024-06-04 00:10:19.879 [61387] main/112/applier/replicator@localhost:3301 I> leaving orphan mode
2024-06-04 00:12:14.064 [61387] applier_1/103/writer/replicator@localhost:3301 I> fiber `writer/replicator@localhost:3301' has been cancelled
2024-06-04 00:12:14.064 [61387] applier_1/103/writer/replicator@localhost:3301 I> fiber `writer/replicator@localhost:3301': exiting
2024-06-04 00:12:14.064 [61387] main/112/applier/replicator@localhost:3301 I> can't read row
2024-06-04 00:12:14.064 [61387] main/112/applier/replicator@localhost:3301 coio.c:353 E> SocketError: unexpected EOF when reading from socket, called on fd 28, aka [::1]:50412, peer of [::1]:3301: Broken pipe
2024-06-04 00:12:14.064 [61387] main/112/applier/replicator@localhost:3301 I> will retry every 1.00 second
2024-06-04 00:12:14.065 [61387] relay/[::1]:50409/101/main coio.c:353 E> SocketError: unexpected EOF when reading from socket, called on fd 13, aka [::1]:3302, peer of [::1]:50409: Broken pipe
2024-06-04 00:12:14.065 [61387] relay/[::1]:50409/101/main I> exiting the relay loop
2024-06-04 00:12:14.165 [61387] main C> got signal 2 - Interrupt: 2
2024-06-04 00:12:14.165 [61387] main/130/iproto.shutdown I> tx_binary: stopped
2024-06-04 00:12:14.166 [61387] main/103/on_shutdown I> leaving orphan mode
Watchdog 2024/06/04 00:12:14 (INFO): the Instance has shutdown.
Watchdog 2024/06/04 00:12:31 (INFO): using "/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/config.yaml" cluster config for instance "storage-001-b"
started
2024-06-04 00:12:32.127 [61626] main/104/interactive I> Tarantool 3.1.0-0-g96f6d88 Darwin-x86_64-Release
2024-06-04 00:12:32.128 [61626] main/104/interactive I> log level 5 (INFO)
2024-06-04 00:12:32.128 [61626] main/104/interactive I> wal/engine cleanup is paused
2024-06-04 00:12:32.128 [61626] main/104/interactive I> mapping 268435456 bytes for memtx tuple arena...
2024-06-04 00:12:32.128 [61626] main/104/interactive I> Actual slab_alloc_factor calculated on the basis of desired slab_alloc_factor = 1.044274
2024-06-04 00:12:32.128 [61626] main/104/interactive I> mapping 134217728 bytes for vinyl tuple arena...
2024-06-04 00:12:32.128 [61626] main/104/interactive/box.upgrade I> Recovering snapshot with schema version 3.1.0
2024-06-04 00:12:32.130 [61626] main/104/interactive I> update replication_synchro_quorum = 1
2024-06-04 00:12:32.130 [61626] main/104/interactive I> instance uuid 7411d451-49e1-4373-9fed-0a2c2a7b10a8
2024-06-04 00:12:32.130 [61626] main/104/interactive I> instance vclock {1: 1069}
2024-06-04 00:12:32.131 [61626] main/104/interactive I> tx_binary: bound to [::1]:3302
2024-06-04 00:12:32.131 [61626] main/104/interactive I> connecting to 2 replicas
2024-06-04 00:12:32.132 [61626] main/112/applier/replicator@localhost:3301 I> remote master 33425648-d2aa-4911-9c90-dd6ec549d048 at [::1]:3301 running Tarantool 3.1.0
2024-06-04 00:12:32.132 [61626] main/113/applier/replicator@localhost:3302 I> remote master 7411d451-49e1-4373-9fed-0a2c2a7b10a8 at [::1]:3302 running Tarantool 3.1.0
2024-06-04 00:12:32.133 [61626] main/104/interactive I> connected to 2 replicas
2024-06-04 00:12:32.133 [61626] main/104/interactive I> recovery start
2024-06-04 00:12:32.133 [61626] main/104/interactive I> recovering from `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/var/lib/storage-001-b/00000000000000000064.snap'
2024-06-04 00:12:32.133 [61626] main/104/interactive I> replicaset name: storage-001
2024-06-04 00:12:32.133 [61626] main/104/interactive I> replicaset uuid c903494a-bc47-40f2-9266-58472b3f5734
2024-06-04 00:12:32.154 [61626] main/104/interactive I> assigned id 1 to replica 33425648-d2aa-4911-9c90-dd6ec549d048
2024-06-04 00:12:32.154 [61626] main/104/interactive I> update replication_synchro_quorum = 1
2024-06-04 00:12:32.154 [61626] main/104/interactive I> assigned name storage-001-a to replica 33425648-d2aa-4911-9c90-dd6ec549d048
2024-06-04 00:12:32.154 [61626] main/104/interactive I> assigned id 2 to replica 7411d451-49e1-4373-9fed-0a2c2a7b10a8
2024-06-04 00:12:32.154 [61626] main/104/interactive I> update replication_synchro_quorum = 2
2024-06-04 00:12:32.154 [61626] main/104/interactive I> RAFT: fencing paused
2024-06-04 00:12:32.154 [61626] main/104/interactive I> assigned name storage-001-b to replica 7411d451-49e1-4373-9fed-0a2c2a7b10a8
2024-06-04 00:12:32.154 [61626] main/104/interactive I> recover from `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/var/lib/storage-001-b/00000000000000000064.xlog'
2024-06-04 00:12:32.155 [61626] main/104/interactive I> done `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/var/lib/storage-001-b/00000000000000000064.xlog'
2024-06-04 00:12:32.155 [61626] main/104/interactive I> recover from `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/var/lib/storage-001-b/00000000000000001066.xlog'
2024-06-04 00:12:32.155 [61626] main/104/interactive I> done `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/var/lib/storage-001-b/00000000000000001066.xlog'
2024-06-04 00:12:32.155 [61626] main/104/interactive I> recover from `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/var/lib/storage-001-b/00000000000000001068.xlog'
2024-06-04 00:12:32.155 [61626] main/104/interactive I> done `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/var/lib/storage-001-b/00000000000000001068.xlog'
2024-06-04 00:12:32.155 [61626] main/104/interactive I> recover from `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/var/lib/storage-001-b/00000000000000001069.xlog'
2024-06-04 00:12:32.155 [61626] main/104/interactive I> done `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/var/lib/storage-001-b/00000000000000001069.xlog'
2024-06-04 00:12:32.156 [61626] main/104/interactive I> Building secondary indexes in space '_bucket'...
2024-06-04 00:12:32.156 [61626] main/104/interactive I> Adding 500 keys to TREE index 'status' ...
2024-06-04 00:12:32.156 [61626] main/104/interactive I> Space '_bucket': done
2024-06-04 00:12:32.156 [61626] main/104/interactive I> Building secondary indexes in space 'messages'...
2024-06-04 00:12:32.156 [61626] main/104/interactive I> Adding 5 keys to TREE index 'bucket_id' ...
2024-06-04 00:12:32.156 [61626] main/104/interactive I> Adding 5 keys to TREE index 'dialog_hash' ...
2024-06-04 00:12:32.156 [61626] main/104/interactive I> Space 'messages': done
2024-06-04 00:12:32.156 [61626] main/104/interactive I> ready to accept requests
2024-06-04 00:12:32.156 [61626] main/104/interactive I> synchronizing with 2 replicas
2024-06-04 00:12:32.156 [61626] main/104/interactive C> failed to synchronize with 1 out of 2 replicas
2024-06-04 00:12:32.156 [61626] main/104/interactive I> entering orphan mode
2024-06-04 00:12:32.156 [61626] main/104/interactive/box.load_cfg I> set 'instance_name' configuration option to "storage-001-b"
2024-06-04 00:12:32.156 [61626] main/104/interactive/box.load_cfg I> set 'custom_proc_title' configuration option to "tarantool - storage-001-b"
2024-06-04 00:12:32.156 [61626] main/104/interactive/box.load_cfg I> set 'log_nonblock' configuration option to false
2024-06-04 00:12:32.156 [61626] main/104/interactive/box.load_cfg I> set 'replication' configuration option to ["replicator@localhost:3301","replicator@localhost:3302"]
2024-06-04 00:12:32.156 [61626] main/104/interactive/box.load_cfg I> set 'replicaset_name' configuration option to "storage-001"
2024-06-04 00:12:32.156 [61626] main/104/interactive/box.load_cfg I> set 'listen' configuration option to [{"uri":"localhost:3302"}]
2024-06-04 00:12:32.156 [61626] main/107/checkpoint_daemon I> scheduled next checkpoint for Tue Jun  4 01:31:34 2024
2024-06-04 00:12:32.156 [61626] main/112/applier/replicator@localhost:3301 I> failed to authenticate
2024-06-04 00:12:32.156 [61626] main/112/applier/replicator@localhost:3301 box.cc:4283 E> ER_LOADING: Instance bootstrap hasn't finished yet
2024-06-04 00:12:32.156 [61626] main/112/applier/replicator@localhost:3301 I> will retry every 1.00 second
2024-06-04 00:12:32.156 [61626] main/104/interactive/box.load_cfg I> set 'metrics' configuration option to {"labels":{"alias":"storage-001-b"},"include":["all"],"exclude":[]}
2024-06-04 00:12:32.156 [61626] main/104/interactive/box.load_cfg I> set 'read_only' configuration option to true
2024-06-04 00:12:32.174 [61626] main/119/console/unix/: sio.c:315 !> getpeername: Invalid argument
2024-06-04 00:12:32.175 [61626] main/104/interactive I> update replication_synchro_quorum = 2
2024-06-04 00:12:32.176 [61626] main/107/checkpoint_daemon I> scheduled next checkpoint for Tue Jun  4 02:12:15 2024
2024-06-04 00:12:32.213 [61626] main/104/interactive/tarantool.config I> sharding: apply storage config
2024-06-04 00:12:32.213 [61626] main/104/interactive/vshard.storage I> Starting configuration of replica storage-001-b
2024-06-04 00:12:32.213 [61626] main/104/interactive/vshard.storage I> Box configuration was skipped due to the 'manual' box_cfg_mode
2024-06-04 00:12:32.213 [61626] main/124/vshard.state_watch/vshard.util I> instance_watch_f has been started
2024-06-04 00:12:32.213 [61626] main/126/vshard.conn_man/vshard.util I> conn_manager_f has been started
2024-06-04 00:12:32.220 [61626] main I> entering the event loop
2024-06-04 00:12:33.160 [61626] main/111/main I> subscribed replica 33425648-d2aa-4911-9c90-dd6ec549d048 at fd 13, aka [::1]:3302, peer of [::1]:50495
2024-06-04 00:12:33.160 [61626] main/111/main I> remote vclock {1: 1069} local vclock {1: 1069}
2024-06-04 00:12:33.160 [61626] main/106/gc I> wal/engine cleanup is resumed
2024-06-04 00:12:33.161 [61626] relay/[::1]:50495/101/main I> recover from `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/var/lib/storage-001-b/00000000000000001069.xlog'
2024-06-04 00:12:33.177 [61626] main/112/applier/replicator@localhost:3301 I> authenticated
2024-06-04 00:12:33.177 [61626] main/112/applier/replicator@localhost:3301 I> subscribed
2024-06-04 00:12:33.177 [61626] main/112/applier/replicator@localhost:3301 I> remote vclock {1: 1069} local vclock {1: 1069}
2024-06-04 00:12:33.177 [61626] main/112/applier/replicator@localhost:3301 I> RAFT: message {term: 1, state: follower} from 1
2024-06-04 00:12:33.178 [61626] main/112/applier/replicator@localhost:3301 I> leaving orphan mode
2024-06-04 00:38:47.095 [61626] applier_1/103/writer/replicator@localhost:3301 I> fiber `writer/replicator@localhost:3301' has been cancelled
2024-06-04 00:38:47.095 [61626] applier_1/103/writer/replicator@localhost:3301 I> fiber `writer/replicator@localhost:3301': exiting
2024-06-04 00:38:47.095 [61626] main/112/applier/replicator@localhost:3301 I> can't read row
2024-06-04 00:38:47.095 [61626] main/112/applier/replicator@localhost:3301 coio.c:353 E> SocketError: unexpected EOF when reading from socket, called on fd 26, aka [::1]:50497, peer of [::1]:3301: Broken pipe
2024-06-04 00:38:47.095 [61626] main/112/applier/replicator@localhost:3301 I> will retry every 1.00 second
2024-06-04 00:38:47.096 [61626] relay/[::1]:50495/101/main coio.c:353 E> SocketError: unexpected EOF when reading from socket, called on fd 13, aka [::1]:3302, peer of [::1]:50495: Broken pipe
2024-06-04 00:38:47.096 [61626] relay/[::1]:50495/101/main I> exiting the relay loop
2024-06-04 00:38:47.194 [61626] main C> got signal 2 - Interrupt: 2
2024-06-04 00:38:47.195 [61626] main/130/iproto.shutdown I> tx_binary: stopped
2024-06-04 00:38:47.196 [61626] main/103/on_shutdown I> leaving orphan mode
Watchdog 2024/06/04 00:38:47 (INFO): the Instance has shutdown.
Watchdog 2024/06/04 00:38:47 (INFO): using "/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/config.yaml" cluster config for instance "storage-001-b"
started
2024-06-04 00:38:47.870 [64893] main/104/interactive I> Tarantool 3.1.0-0-g96f6d88 Darwin-x86_64-Release
2024-06-04 00:38:47.871 [64893] main/104/interactive I> log level 5 (INFO)
2024-06-04 00:38:47.871 [64893] main/104/interactive I> wal/engine cleanup is paused
2024-06-04 00:38:47.871 [64893] main/104/interactive I> mapping 268435456 bytes for memtx tuple arena...
2024-06-04 00:38:47.871 [64893] main/104/interactive I> Actual slab_alloc_factor calculated on the basis of desired slab_alloc_factor = 1.044274
2024-06-04 00:38:47.871 [64893] main/104/interactive I> mapping 134217728 bytes for vinyl tuple arena...
2024-06-04 00:38:47.872 [64893] main/104/interactive/box.upgrade I> Recovering snapshot with schema version 3.1.0
2024-06-04 00:38:47.873 [64893] main/104/interactive I> update replication_synchro_quorum = 1
2024-06-04 00:38:47.873 [64893] main/104/interactive I> instance uuid 7411d451-49e1-4373-9fed-0a2c2a7b10a8
2024-06-04 00:38:47.873 [64893] main/104/interactive I> instance vclock {1: 1069}
2024-06-04 00:38:47.875 [64893] main/104/interactive I> tx_binary: bound to [::1]:3302
2024-06-04 00:38:47.875 [64893] main/104/interactive I> connecting to 2 replicas
2024-06-04 00:38:47.876 [64893] main/112/applier/replicator@localhost:3301 I> remote master 33425648-d2aa-4911-9c90-dd6ec549d048 at [::1]:3301 running Tarantool 3.1.0
2024-06-04 00:38:47.877 [64893] main/113/applier/replicator@localhost:3302 I> remote master 7411d451-49e1-4373-9fed-0a2c2a7b10a8 at [::1]:3302 running Tarantool 3.1.0
2024-06-04 00:38:47.878 [64893] main/104/interactive I> connected to 2 replicas
2024-06-04 00:38:47.878 [64893] main/104/interactive I> recovery start
2024-06-04 00:38:47.878 [64893] main/104/interactive I> recovering from `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/var/lib/storage-001-b/00000000000000000064.snap'
2024-06-04 00:38:47.878 [64893] main/104/interactive I> replicaset name: storage-001
2024-06-04 00:38:47.878 [64893] main/104/interactive I> replicaset uuid c903494a-bc47-40f2-9266-58472b3f5734
2024-06-04 00:38:47.896 [64893] main/104/interactive I> assigned id 1 to replica 33425648-d2aa-4911-9c90-dd6ec549d048
2024-06-04 00:38:47.896 [64893] main/104/interactive I> update replication_synchro_quorum = 1
2024-06-04 00:38:47.896 [64893] main/104/interactive I> assigned name storage-001-a to replica 33425648-d2aa-4911-9c90-dd6ec549d048
2024-06-04 00:38:47.896 [64893] main/104/interactive I> assigned id 2 to replica 7411d451-49e1-4373-9fed-0a2c2a7b10a8
2024-06-04 00:38:47.896 [64893] main/104/interactive I> update replication_synchro_quorum = 2
2024-06-04 00:38:47.896 [64893] main/104/interactive I> RAFT: fencing paused
2024-06-04 00:38:47.896 [64893] main/104/interactive I> assigned name storage-001-b to replica 7411d451-49e1-4373-9fed-0a2c2a7b10a8
2024-06-04 00:38:47.896 [64893] main/104/interactive I> recover from `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/var/lib/storage-001-b/00000000000000000064.xlog'
2024-06-04 00:38:47.897 [64893] main/104/interactive I> done `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/var/lib/storage-001-b/00000000000000000064.xlog'
2024-06-04 00:38:47.897 [64893] main/104/interactive I> recover from `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/var/lib/storage-001-b/00000000000000001066.xlog'
2024-06-04 00:38:47.897 [64893] main/104/interactive I> done `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/var/lib/storage-001-b/00000000000000001066.xlog'
2024-06-04 00:38:47.897 [64893] main/104/interactive I> recover from `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/var/lib/storage-001-b/00000000000000001068.xlog'
2024-06-04 00:38:47.897 [64893] main/104/interactive I> done `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/var/lib/storage-001-b/00000000000000001068.xlog'
2024-06-04 00:38:47.898 [64893] main/104/interactive I> recover from `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/var/lib/storage-001-b/00000000000000001069.xlog'
2024-06-04 00:38:47.898 [64893] main/104/interactive I> done `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/var/lib/storage-001-b/00000000000000001069.xlog'
2024-06-04 00:38:47.898 [64893] main/104/interactive I> Building secondary indexes in space '_bucket'...
2024-06-04 00:38:47.898 [64893] main/104/interactive I> Adding 500 keys to TREE index 'status' ...
2024-06-04 00:38:47.898 [64893] main/104/interactive I> Space '_bucket': done
2024-06-04 00:38:47.898 [64893] main/104/interactive I> Building secondary indexes in space 'messages'...
2024-06-04 00:38:47.898 [64893] main/104/interactive I> Adding 5 keys to TREE index 'bucket_id' ...
2024-06-04 00:38:47.898 [64893] main/104/interactive I> Adding 5 keys to TREE index 'dialog_hash' ...
2024-06-04 00:38:47.898 [64893] main/104/interactive I> Space 'messages': done
2024-06-04 00:38:47.898 [64893] main/104/interactive I> ready to accept requests
2024-06-04 00:38:47.898 [64893] main/104/interactive I> synchronizing with 2 replicas
2024-06-04 00:38:47.899 [64893] main/104/interactive C> failed to synchronize with 1 out of 2 replicas
2024-06-04 00:38:47.899 [64893] main/104/interactive I> entering orphan mode
2024-06-04 00:38:47.899 [64893] main/104/interactive/box.load_cfg I> set 'instance_name' configuration option to "storage-001-b"
2024-06-04 00:38:47.899 [64893] main/104/interactive/box.load_cfg I> set 'custom_proc_title' configuration option to "tarantool - storage-001-b"
2024-06-04 00:38:47.899 [64893] main/104/interactive/box.load_cfg I> set 'log_nonblock' configuration option to false
2024-06-04 00:38:47.899 [64893] main/104/interactive/box.load_cfg I> set 'replication' configuration option to ["replicator@localhost:3301","replicator@localhost:3302"]
2024-06-04 00:38:47.899 [64893] main/104/interactive/box.load_cfg I> set 'replicaset_name' configuration option to "storage-001"
2024-06-04 00:38:47.899 [64893] main/104/interactive/box.load_cfg I> set 'listen' configuration option to [{"uri":"localhost:3302"}]
2024-06-04 00:38:47.899 [64893] main/107/checkpoint_daemon I> scheduled next checkpoint for Tue Jun  4 01:57:36 2024
2024-06-04 00:38:47.899 [64893] main/104/interactive/box.load_cfg I> set 'metrics' configuration option to {"labels":{"alias":"storage-001-b"},"include":["all"],"exclude":[]}
2024-06-04 00:38:47.899 [64893] main/104/interactive/box.load_cfg I> set 'read_only' configuration option to true
2024-06-04 00:38:47.899 [64893] main/112/applier/replicator@localhost:3301 I> authenticated
2024-06-04 00:38:47.900 [64893] main/111/main I> subscribed replica 33425648-d2aa-4911-9c90-dd6ec549d048 at fd 29, aka [::1]:3302, peer of [::1]:55462
2024-06-04 00:38:47.900 [64893] main/111/main I> remote vclock {1: 1069} local vclock {1: 1069}
2024-06-04 00:38:47.900 [64893] main/106/gc I> wal/engine cleanup is resumed
2024-06-04 00:38:47.900 [64893] relay/[::1]:55462/101/main I> recover from `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/var/lib/storage-001-b/00000000000000001069.xlog'
2024-06-04 00:38:47.914 [64893] main/112/applier/replicator@localhost:3301 I> subscribed
2024-06-04 00:38:47.914 [64893] main/112/applier/replicator@localhost:3301 I> remote vclock {1: 1069} local vclock {1: 1069}
2024-06-04 00:38:47.915 [64893] main/112/applier/replicator@localhost:3301 I> RAFT: message {term: 1, state: follower} from 1
2024-06-04 00:38:47.915 [64893] main/112/applier/replicator@localhost:3301 I> leaving orphan mode
2024-06-04 00:38:47.916 [64893] main/120/console/unix/: sio.c:315 !> getpeername: Invalid argument
2024-06-04 00:38:47.917 [64893] main/104/interactive I> update replication_synchro_quorum = 2
2024-06-04 00:38:47.918 [64893] main/107/checkpoint_daemon I> scheduled next checkpoint for Tue Jun  4 01:39:35 2024
2024-06-04 00:38:47.953 [64893] main/104/interactive/tarantool.config I> sharding: apply storage config
2024-06-04 00:38:47.953 [64893] main/104/interactive/vshard.storage I> Starting configuration of replica storage-001-b
2024-06-04 00:38:47.953 [64893] main/104/interactive/vshard.storage I> Box configuration was skipped due to the 'manual' box_cfg_mode
2024-06-04 00:38:47.953 [64893] main/125/vshard.state_watch/vshard.util I> instance_watch_f has been started
2024-06-04 00:38:47.953 [64893] main/127/vshard.conn_man/vshard.util I> conn_manager_f has been started
2024-06-04 00:38:47.961 [64893] main I> entering the event loop
2024-06-04 00:40:53.843 [64893] applier_1/103/writer/replicator@localhost:3301 I> fiber `writer/replicator@localhost:3301' has been cancelled
2024-06-04 00:40:53.843 [64893] applier_1/103/writer/replicator@localhost:3301 I> fiber `writer/replicator@localhost:3301': exiting
2024-06-04 00:40:53.843 [64893] main/112/applier/replicator@localhost:3301 I> can't read row
2024-06-04 00:40:53.843 [64893] main/112/applier/replicator@localhost:3301 coio.c:353 E> SocketError: unexpected EOF when reading from socket, called on fd 26, aka [::1]:55464, peer of [::1]:3301: Broken pipe
2024-06-04 00:40:53.843 [64893] main/112/applier/replicator@localhost:3301 I> will retry every 1.00 second
2024-06-04 00:40:53.844 [64893] relay/[::1]:55462/101/main coio.c:353 E> SocketError: unexpected EOF when reading from socket, called on fd 29, aka [::1]:3302, peer of [::1]:55462: Broken pipe
2024-06-04 00:40:53.844 [64893] relay/[::1]:55462/101/main I> exiting the relay loop
2024-06-04 00:40:53.944 [64893] main C> got signal 2 - Interrupt: 2
2024-06-04 00:40:53.945 [64893] main/128/iproto.shutdown I> tx_binary: stopped
2024-06-04 00:40:53.946 [64893] main/103/on_shutdown I> leaving orphan mode
Watchdog 2024/06/04 00:40:53 (INFO): the Instance has shutdown.
Watchdog 2024/06/04 00:40:57 (INFO): using "/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/config.yaml" cluster config for instance "storage-001-b"
started
2024-06-04 00:40:57.569 [65106] main/104/interactive I> Tarantool 3.1.0-0-g96f6d88 Darwin-x86_64-Release
2024-06-04 00:40:57.569 [65106] main/104/interactive I> log level 5 (INFO)
2024-06-04 00:40:57.569 [65106] main/104/interactive I> wal/engine cleanup is paused
2024-06-04 00:40:57.569 [65106] main/104/interactive I> mapping 268435456 bytes for memtx tuple arena...
2024-06-04 00:40:57.570 [65106] main/104/interactive I> Actual slab_alloc_factor calculated on the basis of desired slab_alloc_factor = 1.044274
2024-06-04 00:40:57.570 [65106] main/104/interactive I> mapping 134217728 bytes for vinyl tuple arena...
2024-06-04 00:40:57.570 [65106] main/104/interactive/box.upgrade I> Recovering snapshot with schema version 3.1.0
2024-06-04 00:40:57.572 [65106] main/104/interactive I> update replication_synchro_quorum = 1
2024-06-04 00:40:57.572 [65106] main/104/interactive I> instance uuid 7411d451-49e1-4373-9fed-0a2c2a7b10a8
2024-06-04 00:40:57.572 [65106] main/104/interactive I> instance vclock {1: 1069}
2024-06-04 00:40:57.574 [65106] main/104/interactive I> tx_binary: bound to [::1]:3302
2024-06-04 00:40:57.574 [65106] main/104/interactive I> connecting to 2 replicas
2024-06-04 00:40:57.575 [65106] main/112/applier/replicator@localhost:3301 I> remote master 33425648-d2aa-4911-9c90-dd6ec549d048 at [::1]:3301 running Tarantool 3.1.0
2024-06-04 00:40:57.575 [65106] main/113/applier/replicator@localhost:3302 I> remote master 7411d451-49e1-4373-9fed-0a2c2a7b10a8 at [::1]:3302 running Tarantool 3.1.0
2024-06-04 00:40:57.576 [65106] main/104/interactive I> connected to 2 replicas
2024-06-04 00:40:57.577 [65106] main/104/interactive I> recovery start
2024-06-04 00:40:57.577 [65106] main/104/interactive I> recovering from `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/var/lib/storage-001-b/00000000000000000064.snap'
2024-06-04 00:40:57.577 [65106] main/104/interactive I> replicaset name: storage-001
2024-06-04 00:40:57.577 [65106] main/104/interactive I> replicaset uuid c903494a-bc47-40f2-9266-58472b3f5734
2024-06-04 00:40:57.596 [65106] main/104/interactive I> assigned id 1 to replica 33425648-d2aa-4911-9c90-dd6ec549d048
2024-06-04 00:40:57.596 [65106] main/104/interactive I> update replication_synchro_quorum = 1
2024-06-04 00:40:57.596 [65106] main/104/interactive I> assigned name storage-001-a to replica 33425648-d2aa-4911-9c90-dd6ec549d048
2024-06-04 00:40:57.596 [65106] main/104/interactive I> assigned id 2 to replica 7411d451-49e1-4373-9fed-0a2c2a7b10a8
2024-06-04 00:40:57.596 [65106] main/104/interactive I> update replication_synchro_quorum = 2
2024-06-04 00:40:57.596 [65106] main/104/interactive I> RAFT: fencing paused
2024-06-04 00:40:57.596 [65106] main/104/interactive I> assigned name storage-001-b to replica 7411d451-49e1-4373-9fed-0a2c2a7b10a8
2024-06-04 00:40:57.596 [65106] main/104/interactive I> recover from `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/var/lib/storage-001-b/00000000000000000064.xlog'
2024-06-04 00:40:57.597 [65106] main/104/interactive I> done `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/var/lib/storage-001-b/00000000000000000064.xlog'
2024-06-04 00:40:57.597 [65106] main/104/interactive I> recover from `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/var/lib/storage-001-b/00000000000000001066.xlog'
2024-06-04 00:40:57.597 [65106] main/104/interactive I> done `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/var/lib/storage-001-b/00000000000000001066.xlog'
2024-06-04 00:40:57.597 [65106] main/104/interactive I> recover from `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/var/lib/storage-001-b/00000000000000001068.xlog'
2024-06-04 00:40:57.597 [65106] main/104/interactive I> done `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/var/lib/storage-001-b/00000000000000001068.xlog'
2024-06-04 00:40:57.597 [65106] main/104/interactive I> recover from `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/var/lib/storage-001-b/00000000000000001069.xlog'
2024-06-04 00:40:57.597 [65106] main/104/interactive I> done `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/var/lib/storage-001-b/00000000000000001069.xlog'
2024-06-04 00:40:57.598 [65106] main/104/interactive I> Building secondary indexes in space '_bucket'...
2024-06-04 00:40:57.598 [65106] main/104/interactive I> Adding 500 keys to TREE index 'status' ...
2024-06-04 00:40:57.598 [65106] main/104/interactive I> Space '_bucket': done
2024-06-04 00:40:57.598 [65106] main/104/interactive I> Building secondary indexes in space 'messages'...
2024-06-04 00:40:57.598 [65106] main/104/interactive I> Adding 5 keys to TREE index 'bucket_id' ...
2024-06-04 00:40:57.598 [65106] main/104/interactive I> Adding 5 keys to TREE index 'dialog_hash' ...
2024-06-04 00:40:57.598 [65106] main/104/interactive I> Space 'messages': done
2024-06-04 00:40:57.598 [65106] main/104/interactive I> ready to accept requests
2024-06-04 00:40:57.598 [65106] main/104/interactive I> synchronizing with 2 replicas
2024-06-04 00:40:57.598 [65106] main/104/interactive C> failed to synchronize with 1 out of 2 replicas
2024-06-04 00:40:57.598 [65106] main/104/interactive I> entering orphan mode
2024-06-04 00:40:57.598 [65106] main/104/interactive/box.load_cfg I> set 'instance_name' configuration option to "storage-001-b"
2024-06-04 00:40:57.598 [65106] main/104/interactive/box.load_cfg I> set 'custom_proc_title' configuration option to "tarantool - storage-001-b"
2024-06-04 00:40:57.598 [65106] main/104/interactive/box.load_cfg I> set 'log_nonblock' configuration option to false
2024-06-04 00:40:57.598 [65106] main/104/interactive/box.load_cfg I> set 'replication' configuration option to ["replicator@localhost:3301","replicator@localhost:3302"]
2024-06-04 00:40:57.598 [65106] main/104/interactive/box.load_cfg I> set 'replicaset_name' configuration option to "storage-001"
2024-06-04 00:40:57.598 [65106] main/104/interactive/box.load_cfg I> set 'listen' configuration option to [{"uri":"localhost:3302"}]
2024-06-04 00:40:57.598 [65106] main/107/checkpoint_daemon I> scheduled next checkpoint for Tue Jun  4 02:20:23 2024
2024-06-04 00:40:57.598 [65106] main/104/interactive/box.load_cfg I> set 'metrics' configuration option to {"labels":{"alias":"storage-001-b"},"include":["all"],"exclude":[]}
2024-06-04 00:40:57.599 [65106] main/104/interactive/box.load_cfg I> set 'read_only' configuration option to true
2024-06-04 00:40:57.599 [65106] main/112/applier/replicator@localhost:3301 I> authenticated
2024-06-04 00:40:57.599 [65106] main/111/main I> subscribed replica 33425648-d2aa-4911-9c90-dd6ec549d048 at fd 26, aka [::1]:3302, peer of [::1]:55949
2024-06-04 00:40:57.599 [65106] main/111/main I> remote vclock {1: 1069} local vclock {1: 1069}
2024-06-04 00:40:57.599 [65106] main/106/gc I> wal/engine cleanup is resumed
2024-06-04 00:40:57.599 [65106] main/112/applier/replicator@localhost:3301 I> subscribed
2024-06-04 00:40:57.599 [65106] main/112/applier/replicator@localhost:3301 I> remote vclock {1: 1069} local vclock {1: 1069}
2024-06-04 00:40:57.600 [65106] relay/[::1]:55949/101/main I> recover from `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/var/lib/storage-001-b/00000000000000001069.xlog'
2024-06-04 00:40:57.615 [65106] main/112/applier/replicator@localhost:3301 I> RAFT: message {term: 1, state: follower} from 1
2024-06-04 00:40:57.615 [65106] main/112/applier/replicator@localhost:3301 I> leaving orphan mode
2024-06-04 00:40:57.617 [65106] main/120/console/unix/: sio.c:315 !> getpeername: Invalid argument
2024-06-04 00:40:57.618 [65106] main/104/interactive I> update replication_synchro_quorum = 2
2024-06-04 00:40:57.619 [65106] main/107/checkpoint_daemon I> scheduled next checkpoint for Tue Jun  4 02:31:12 2024
2024-06-04 00:40:57.658 [65106] main/104/interactive/tarantool.config I> sharding: apply storage config
2024-06-04 00:40:57.659 [65106] main/104/interactive/vshard.storage I> Starting configuration of replica storage-001-b
2024-06-04 00:40:57.659 [65106] main/104/interactive/vshard.storage I> Box configuration was skipped due to the 'manual' box_cfg_mode
2024-06-04 00:40:57.659 [65106] main/125/vshard.state_watch/vshard.util I> instance_watch_f has been started
2024-06-04 00:40:57.659 [65106] main/127/vshard.conn_man/vshard.util I> conn_manager_f has been started
2024-06-04 00:40:57.667 [65106] main I> entering the event loop
2024-06-04 00:42:46.398 [65106] main C> got signal 2 - Interrupt: 2
2024-06-04 00:42:46.399 [65106] main/128/iproto.shutdown I> tx_binary: stopped
2024-06-04 00:42:46.399 [65106] relay/[::1]:55949/101/main I> fiber `main' has been cancelled
2024-06-04 00:42:46.399 [65106] relay/[::1]:55949/101/main I> fiber `main': exiting
2024-06-04 00:42:46.399 [65106] relay/[::1]:55949/101/main I> exiting the relay loop
2024-06-04 00:42:46.400 [65106] applier_1/103/writer/replicator@localhost:3301 I> fiber `writer/replicator@localhost:3301' has been cancelled
2024-06-04 00:42:46.400 [65106] applier_1/103/writer/replicator@localhost:3301 I> fiber `writer/replicator@localhost:3301': exiting
Watchdog 2024/06/04 00:42:46 (INFO): the Instance has shutdown.
Watchdog 2024/06/04 00:42:47 (INFO): using "/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/config.yaml" cluster config for instance "storage-001-b"
started
2024-06-04 00:42:47.195 [65214] main/104/interactive I> Tarantool 3.1.0-0-g96f6d88 Darwin-x86_64-Release
2024-06-04 00:42:47.196 [65214] main/104/interactive I> log level 5 (INFO)
2024-06-04 00:42:47.196 [65214] main/104/interactive I> wal/engine cleanup is paused
2024-06-04 00:42:47.196 [65214] main/104/interactive I> mapping 268435456 bytes for memtx tuple arena...
2024-06-04 00:42:47.196 [65214] main/104/interactive I> Actual slab_alloc_factor calculated on the basis of desired slab_alloc_factor = 1.044274
2024-06-04 00:42:47.196 [65214] main/104/interactive I> mapping 134217728 bytes for vinyl tuple arena...
2024-06-04 00:42:47.196 [65214] main/104/interactive/box.upgrade I> Recovering snapshot with schema version 3.1.0
2024-06-04 00:42:47.197 [65214] main/104/interactive I> update replication_synchro_quorum = 1
2024-06-04 00:42:47.197 [65214] main/104/interactive I> instance uuid 7411d451-49e1-4373-9fed-0a2c2a7b10a8
2024-06-04 00:42:47.198 [65214] main/104/interactive I> instance vclock {1: 1069}
2024-06-04 00:42:47.199 [65214] main/104/interactive I> tx_binary: bound to [::1]:3302
2024-06-04 00:42:47.199 [65214] main/104/interactive I> connecting to 2 replicas
2024-06-04 00:42:47.200 [65214] main/113/applier/replicator@localhost:3302 I> remote master 7411d451-49e1-4373-9fed-0a2c2a7b10a8 at [::1]:3302 running Tarantool 3.1.0
2024-06-04 00:42:47.200 [65214] main/112/applier/replicator@localhost:3301 I> remote master 33425648-d2aa-4911-9c90-dd6ec549d048 at [::1]:3301 running Tarantool 3.1.0
2024-06-04 00:42:47.201 [65214] main/104/interactive I> connected to 2 replicas
2024-06-04 00:42:47.202 [65214] main/104/interactive I> recovery start
2024-06-04 00:42:47.202 [65214] main/104/interactive I> recovering from `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/var/lib/storage-001-b/00000000000000000064.snap'
2024-06-04 00:42:47.202 [65214] main/104/interactive I> replicaset name: storage-001
2024-06-04 00:42:47.202 [65214] main/104/interactive I> replicaset uuid c903494a-bc47-40f2-9266-58472b3f5734
2024-06-04 00:42:47.223 [65214] main/104/interactive I> assigned id 1 to replica 33425648-d2aa-4911-9c90-dd6ec549d048
2024-06-04 00:42:47.223 [65214] main/104/interactive I> update replication_synchro_quorum = 1
2024-06-04 00:42:47.223 [65214] main/104/interactive I> assigned name storage-001-a to replica 33425648-d2aa-4911-9c90-dd6ec549d048
2024-06-04 00:42:47.223 [65214] main/104/interactive I> assigned id 2 to replica 7411d451-49e1-4373-9fed-0a2c2a7b10a8
2024-06-04 00:42:47.223 [65214] main/104/interactive I> update replication_synchro_quorum = 2
2024-06-04 00:42:47.223 [65214] main/104/interactive I> RAFT: fencing paused
2024-06-04 00:42:47.223 [65214] main/104/interactive I> assigned name storage-001-b to replica 7411d451-49e1-4373-9fed-0a2c2a7b10a8
2024-06-04 00:42:47.224 [65214] main/104/interactive I> recover from `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/var/lib/storage-001-b/00000000000000000064.xlog'
2024-06-04 00:42:47.225 [65214] main/104/interactive I> done `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/var/lib/storage-001-b/00000000000000000064.xlog'
2024-06-04 00:42:47.225 [65214] main/104/interactive I> recover from `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/var/lib/storage-001-b/00000000000000001066.xlog'
2024-06-04 00:42:47.225 [65214] main/104/interactive I> done `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/var/lib/storage-001-b/00000000000000001066.xlog'
2024-06-04 00:42:47.225 [65214] main/104/interactive I> recover from `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/var/lib/storage-001-b/00000000000000001068.xlog'
2024-06-04 00:42:47.225 [65214] main/104/interactive I> done `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/var/lib/storage-001-b/00000000000000001068.xlog'
2024-06-04 00:42:47.225 [65214] main/104/interactive I> recover from `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/var/lib/storage-001-b/00000000000000001069.xlog'
2024-06-04 00:42:47.225 [65214] main/104/interactive I> done `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/var/lib/storage-001-b/00000000000000001069.xlog'
2024-06-04 00:42:47.225 [65214] main/104/interactive I> Building secondary indexes in space '_bucket'...
2024-06-04 00:42:47.225 [65214] main/104/interactive I> Adding 500 keys to TREE index 'status' ...
2024-06-04 00:42:47.225 [65214] main/104/interactive I> Space '_bucket': done
2024-06-04 00:42:47.226 [65214] main/104/interactive I> Building secondary indexes in space 'messages'...
2024-06-04 00:42:47.226 [65214] main/104/interactive I> Adding 5 keys to TREE index 'bucket_id' ...
2024-06-04 00:42:47.226 [65214] main/104/interactive I> Adding 5 keys to TREE index 'dialog_hash' ...
2024-06-04 00:42:47.226 [65214] main/104/interactive I> Space 'messages': done
2024-06-04 00:42:47.226 [65214] main/104/interactive I> ready to accept requests
2024-06-04 00:42:47.226 [65214] main/104/interactive I> synchronizing with 2 replicas
2024-06-04 00:42:47.226 [65214] main/104/interactive C> failed to synchronize with 1 out of 2 replicas
2024-06-04 00:42:47.226 [65214] main/104/interactive I> entering orphan mode
2024-06-04 00:42:47.226 [65214] main/112/applier/replicator@localhost:3301 I> authenticated
2024-06-04 00:42:47.226 [65214] main/104/interactive/box.load_cfg I> set 'instance_name' configuration option to "storage-001-b"
2024-06-04 00:42:47.226 [65214] main/104/interactive/box.load_cfg I> set 'custom_proc_title' configuration option to "tarantool - storage-001-b"
2024-06-04 00:42:47.226 [65214] main/104/interactive/box.load_cfg I> set 'log_nonblock' configuration option to false
2024-06-04 00:42:47.226 [65214] main/104/interactive/box.load_cfg I> set 'replication' configuration option to ["replicator@localhost:3301","replicator@localhost:3302"]
2024-06-04 00:42:47.226 [65214] main/104/interactive/box.load_cfg I> set 'replicaset_name' configuration option to "storage-001"
2024-06-04 00:42:47.226 [65214] main/104/interactive/box.load_cfg I> set 'listen' configuration option to [{"uri":"localhost:3302"}]
2024-06-04 00:42:47.226 [65214] main/107/checkpoint_daemon I> scheduled next checkpoint for Tue Jun  4 02:32:12 2024
2024-06-04 00:42:47.226 [65214] main/112/applier/replicator@localhost:3301 I> subscribed
2024-06-04 00:42:47.226 [65214] main/112/applier/replicator@localhost:3301 I> remote vclock {1: 1069} local vclock {1: 1069}
2024-06-04 00:42:47.226 [65214] main/104/interactive/box.load_cfg I> set 'metrics' configuration option to {"labels":{"alias":"storage-001-b"},"include":["all"],"exclude":[]}
2024-06-04 00:42:47.227 [65214] main/104/interactive/box.load_cfg I> set 'read_only' configuration option to true
2024-06-04 00:42:47.227 [65214] main/112/applier/replicator@localhost:3301 I> RAFT: message {term: 1, state: follower} from 1
2024-06-04 00:42:47.250 [65214] main/119/console/unix/: sio.c:315 !> getpeername: Invalid argument
2024-06-04 00:42:47.250 [65214] main/112/applier/replicator@localhost:3301 I> leaving orphan mode
2024-06-04 00:42:47.251 [65214] main/104/interactive I> update replication_synchro_quorum = 2
2024-06-04 00:42:47.252 [65214] main/107/checkpoint_daemon I> scheduled next checkpoint for Tue Jun  4 02:06:02 2024
2024-06-04 00:42:47.293 [65214] main/104/interactive/tarantool.config I> sharding: apply storage config
2024-06-04 00:42:47.293 [65214] main/104/interactive/vshard.storage I> Starting configuration of replica storage-001-b
2024-06-04 00:42:47.293 [65214] main/104/interactive/vshard.storage I> Box configuration was skipped due to the 'manual' box_cfg_mode
2024-06-04 00:42:47.293 [65214] main/124/vshard.state_watch/vshard.util I> instance_watch_f has been started
2024-06-04 00:42:47.294 [65214] main/126/vshard.conn_man/vshard.util I> conn_manager_f has been started
2024-06-04 00:42:47.303 [65214] main I> entering the event loop
2024-06-04 00:42:48.227 [65214] main/111/main I> subscribed replica 33425648-d2aa-4911-9c90-dd6ec549d048 at fd 13, aka [::1]:3302, peer of [::1]:56427
2024-06-04 00:42:48.227 [65214] main/111/main I> remote vclock {1: 1069} local vclock {1: 1069}
2024-06-04 00:42:48.227 [65214] main/106/gc I> wal/engine cleanup is resumed
2024-06-04 00:42:48.228 [65214] relay/[::1]:56427/101/main I> recover from `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/var/lib/storage-001-b/00000000000000001069.xlog'
2024-06-04 00:47:03.914 [65214] applier_1/103/writer/replicator@localhost:3301 I> fiber `writer/replicator@localhost:3301' has been cancelled
2024-06-04 00:47:03.914 [65214] applier_1/103/writer/replicator@localhost:3301 I> fiber `writer/replicator@localhost:3301': exiting
2024-06-04 00:47:03.914 [65214] main/112/applier/replicator@localhost:3301 I> can't read row
2024-06-04 00:47:03.914 [65214] main/112/applier/replicator@localhost:3301 coio.c:353 E> SocketError: unexpected EOF when reading from socket, called on fd 26, aka [::1]:56402, peer of [::1]:3301: Broken pipe
2024-06-04 00:47:03.914 [65214] main/112/applier/replicator@localhost:3301 I> will retry every 1.00 second
2024-06-04 00:47:03.915 [65214] relay/[::1]:56427/101/main coio.c:353 E> SocketError: unexpected EOF when reading from socket, called on fd 13, aka [::1]:3302, peer of [::1]:56427: Broken pipe
2024-06-04 00:47:03.915 [65214] relay/[::1]:56427/101/main I> exiting the relay loop
2024-06-04 00:47:04.014 [65214] main C> got signal 2 - Interrupt: 2
2024-06-04 00:47:04.014 [65214] main/128/iproto.shutdown I> tx_binary: stopped
2024-06-04 00:47:04.014 [65214] main/103/on_shutdown I> leaving orphan mode
Watchdog 2024/06/04 00:47:04 (INFO): the Instance has shutdown.
Watchdog 2024/06/04 00:47:04 (INFO): using "/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/config.yaml" cluster config for instance "storage-001-b"
started
2024-06-04 00:47:04.619 [65437] main/104/interactive I> Tarantool 3.1.0-0-g96f6d88 Darwin-x86_64-Release
2024-06-04 00:47:04.619 [65437] main/104/interactive I> log level 5 (INFO)
2024-06-04 00:47:04.620 [65437] main/104/interactive I> wal/engine cleanup is paused
2024-06-04 00:47:04.620 [65437] main/104/interactive I> mapping 268435456 bytes for memtx tuple arena...
2024-06-04 00:47:04.620 [65437] main/104/interactive I> Actual slab_alloc_factor calculated on the basis of desired slab_alloc_factor = 1.044274
2024-06-04 00:47:04.620 [65437] main/104/interactive I> mapping 134217728 bytes for vinyl tuple arena...
2024-06-04 00:47:04.621 [65437] main/104/interactive/box.upgrade I> Recovering snapshot with schema version 3.1.0
2024-06-04 00:47:04.622 [65437] main/104/interactive I> update replication_synchro_quorum = 1
2024-06-04 00:47:04.623 [65437] main/104/interactive I> instance uuid 7411d451-49e1-4373-9fed-0a2c2a7b10a8
2024-06-04 00:47:04.624 [65437] main/104/interactive I> instance vclock {1: 1069}
2024-06-04 00:47:04.625 [65437] main/104/interactive I> tx_binary: bound to [::1]:3302
2024-06-04 00:47:04.625 [65437] main/104/interactive I> connecting to 2 replicas
2024-06-04 00:47:04.626 [65437] main/112/applier/replicator@localhost:3301 I> can't connect to master
2024-06-04 00:47:04.626 [65437] main/112/applier/replicator@localhost:3301 coio.c:83 E> SocketError: connect, called on fd 26, aka 127.0.0.1:57405: Connection refused
2024-06-04 00:47:04.626 [65437] main/112/applier/replicator@localhost:3301 I> will retry every 1.00 second
2024-06-04 00:47:04.626 [65437] main/113/applier/replicator@localhost:3302 I> remote master 7411d451-49e1-4373-9fed-0a2c2a7b10a8 at [::1]:3302 running Tarantool 3.1.0
2024-06-04 00:47:05.628 [65437] main/112/applier/replicator@localhost:3301 I> remote master 33425648-d2aa-4911-9c90-dd6ec549d048 at [::1]:3301 running Tarantool 3.1.0
2024-06-04 00:47:05.628 [65437] main/104/interactive I> connected to 2 replicas
2024-06-04 00:47:05.629 [65437] main/104/interactive I> recovery start
2024-06-04 00:47:05.629 [65437] main/104/interactive I> recovering from `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/var/lib/storage-001-b/00000000000000000064.snap'
2024-06-04 00:47:05.629 [65437] main/104/interactive I> replicaset name: storage-001
2024-06-04 00:47:05.629 [65437] main/104/interactive I> replicaset uuid c903494a-bc47-40f2-9266-58472b3f5734
2024-06-04 00:47:05.647 [65437] main/104/interactive I> assigned id 1 to replica 33425648-d2aa-4911-9c90-dd6ec549d048
2024-06-04 00:47:05.647 [65437] main/104/interactive I> update replication_synchro_quorum = 1
2024-06-04 00:47:05.647 [65437] main/104/interactive I> assigned name storage-001-a to replica 33425648-d2aa-4911-9c90-dd6ec549d048
2024-06-04 00:47:05.647 [65437] main/104/interactive I> assigned id 2 to replica 7411d451-49e1-4373-9fed-0a2c2a7b10a8
2024-06-04 00:47:05.647 [65437] main/104/interactive I> update replication_synchro_quorum = 2
2024-06-04 00:47:05.647 [65437] main/104/interactive I> RAFT: fencing paused
2024-06-04 00:47:05.647 [65437] main/104/interactive I> assigned name storage-001-b to replica 7411d451-49e1-4373-9fed-0a2c2a7b10a8
2024-06-04 00:47:05.647 [65437] main/104/interactive I> recover from `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/var/lib/storage-001-b/00000000000000000064.xlog'
2024-06-04 00:47:05.648 [65437] main/104/interactive I> done `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/var/lib/storage-001-b/00000000000000000064.xlog'
2024-06-04 00:47:05.648 [65437] main/104/interactive I> recover from `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/var/lib/storage-001-b/00000000000000001066.xlog'
2024-06-04 00:47:05.648 [65437] main/104/interactive I> done `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/var/lib/storage-001-b/00000000000000001066.xlog'
2024-06-04 00:47:05.648 [65437] main/104/interactive I> recover from `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/var/lib/storage-001-b/00000000000000001068.xlog'
2024-06-04 00:47:05.648 [65437] main/104/interactive I> done `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/var/lib/storage-001-b/00000000000000001068.xlog'
2024-06-04 00:47:05.648 [65437] main/104/interactive I> recover from `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/var/lib/storage-001-b/00000000000000001069.xlog'
2024-06-04 00:47:05.648 [65437] main/104/interactive I> done `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/var/lib/storage-001-b/00000000000000001069.xlog'
2024-06-04 00:47:05.649 [65437] main/104/interactive I> Building secondary indexes in space '_bucket'...
2024-06-04 00:47:05.649 [65437] main/104/interactive I> Adding 500 keys to TREE index 'status' ...
2024-06-04 00:47:05.649 [65437] main/104/interactive I> Space '_bucket': done
2024-06-04 00:47:05.649 [65437] main/104/interactive I> Building secondary indexes in space 'messages'...
2024-06-04 00:47:05.649 [65437] main/104/interactive I> Adding 5 keys to TREE index 'bucket_id' ...
2024-06-04 00:47:05.649 [65437] main/104/interactive I> Adding 5 keys to TREE index 'dialog_hash' ...
2024-06-04 00:47:05.649 [65437] main/104/interactive I> Space 'messages': done
2024-06-04 00:47:05.649 [65437] main/104/interactive I> ready to accept requests
2024-06-04 00:47:05.649 [65437] main/104/interactive I> synchronizing with 2 replicas
2024-06-04 00:47:05.649 [65437] main/104/interactive C> failed to synchronize with 1 out of 2 replicas
2024-06-04 00:47:05.649 [65437] main/104/interactive I> entering orphan mode
2024-06-04 00:47:05.649 [65437] main/112/applier/replicator@localhost:3301 I> authenticated
2024-06-04 00:47:05.650 [65437] main/104/interactive/box.load_cfg I> set 'instance_name' configuration option to "storage-001-b"
2024-06-04 00:47:05.650 [65437] main/104/interactive/box.load_cfg I> set 'custom_proc_title' configuration option to "tarantool - storage-001-b"
2024-06-04 00:47:05.650 [65437] main/104/interactive/box.load_cfg I> set 'log_nonblock' configuration option to false
2024-06-04 00:47:05.650 [65437] main/104/interactive/box.load_cfg I> set 'replication' configuration option to ["replicator@localhost:3301","replicator@localhost:3302"]
2024-06-04 00:47:05.650 [65437] main/104/interactive/box.load_cfg I> set 'replicaset_name' configuration option to "storage-001"
2024-06-04 00:47:05.650 [65437] main/104/interactive/box.load_cfg I> set 'listen' configuration option to [{"uri":"localhost:3302"}]
2024-06-04 00:47:05.650 [65437] main/107/checkpoint_daemon I> scheduled next checkpoint for Tue Jun  4 01:58:57 2024
2024-06-04 00:47:05.650 [65437] main/112/applier/replicator@localhost:3301 I> subscribed
2024-06-04 00:47:05.650 [65437] main/112/applier/replicator@localhost:3301 I> remote vclock {1: 1069} local vclock {1: 1069}
2024-06-04 00:47:05.650 [65437] main/104/interactive/box.load_cfg I> set 'metrics' configuration option to {"labels":{"alias":"storage-001-b"},"include":["all"],"exclude":[]}
2024-06-04 00:47:05.650 [65437] main/104/interactive/box.load_cfg I> set 'read_only' configuration option to true
2024-06-04 00:47:05.650 [65437] main/112/applier/replicator@localhost:3301 I> RAFT: message {term: 1, state: follower} from 1
2024-06-04 00:47:05.650 [65437] main/112/applier/replicator@localhost:3301 I> leaving orphan mode
2024-06-04 00:47:05.668 [65437] main/119/console/unix/: sio.c:315 !> getpeername: Invalid argument
2024-06-04 00:47:05.669 [65437] main/104/interactive I> update replication_synchro_quorum = 2
2024-06-04 00:47:05.670 [65437] main/107/checkpoint_daemon I> scheduled next checkpoint for Tue Jun  4 01:59:01 2024
2024-06-04 00:47:05.717 [65437] main/104/interactive/tarantool.config I> sharding: apply storage config
2024-06-04 00:47:05.717 [65437] main/104/interactive/vshard.storage I> Starting configuration of replica storage-001-b
2024-06-04 00:47:05.717 [65437] main/104/interactive/vshard.storage I> Box configuration was skipped due to the 'manual' box_cfg_mode
2024-06-04 00:47:05.717 [65437] main/124/vshard.state_watch/vshard.util I> instance_watch_f has been started
2024-06-04 00:47:05.717 [65437] main/126/vshard.conn_man/vshard.util I> conn_manager_f has been started
2024-06-04 00:47:05.727 [65437] main I> entering the event loop
2024-06-04 00:47:05.727 [65437] main/111/main I> subscribed replica 33425648-d2aa-4911-9c90-dd6ec549d048 at fd 26, aka [::1]:3302, peer of [::1]:57436
2024-06-04 00:47:05.727 [65437] main/111/main I> remote vclock {1: 1069} local vclock {1: 1069}
2024-06-04 00:47:05.727 [65437] main/106/gc I> wal/engine cleanup is resumed
2024-06-04 00:47:05.728 [65437] relay/[::1]:57436/101/main I> recover from `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/var/lib/storage-001-b/00000000000000001069.xlog'
2024-06-04 01:01:45.025 [65437] applier_1/103/writer/replicator@localhost:3301 I> fiber `writer/replicator@localhost:3301' has been cancelled
2024-06-04 01:01:45.025 [65437] applier_1/103/writer/replicator@localhost:3301 I> fiber `writer/replicator@localhost:3301': exiting
2024-06-04 01:01:45.025 [65437] main/112/applier/replicator@localhost:3301 I> can't read row
2024-06-04 01:01:45.025 [65437] main/112/applier/replicator@localhost:3301 coio.c:353 E> SocketError: unexpected EOF when reading from socket, called on fd 30, aka [::1]:57431, peer of [::1]:3301: Broken pipe
2024-06-04 01:01:45.025 [65437] main/112/applier/replicator@localhost:3301 I> will retry every 1.00 second
2024-06-04 01:01:45.027 [65437] relay/[::1]:57436/101/main coio.c:353 E> SocketError: unexpected EOF when reading from socket, called on fd 26, aka [::1]:3302, peer of [::1]:57436: Broken pipe
2024-06-04 01:01:45.027 [65437] relay/[::1]:57436/101/main I> exiting the relay loop
2024-06-04 01:01:45.125 [65437] main C> got signal 2 - Interrupt: 2
2024-06-04 01:01:45.125 [65437] main/128/iproto.shutdown I> tx_binary: stopped
2024-06-04 01:01:45.127 [65437] main/103/on_shutdown I> leaving orphan mode
Watchdog 2024/06/04 01:01:45 (INFO): the Instance has shutdown.
Watchdog 2024/06/04 01:01:46 (INFO): using "/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/config.yaml" cluster config for instance "storage-001-b"
started
2024-06-04 01:01:46.796 [68160] main/104/interactive I> Tarantool 3.1.0-0-g96f6d88 Darwin-x86_64-Release
2024-06-04 01:01:46.797 [68160] main/104/interactive I> log level 5 (INFO)
2024-06-04 01:01:46.797 [68160] main/104/interactive I> wal/engine cleanup is paused
2024-06-04 01:01:46.797 [68160] main/104/interactive I> mapping 268435456 bytes for memtx tuple arena...
2024-06-04 01:01:46.797 [68160] main/104/interactive I> Actual slab_alloc_factor calculated on the basis of desired slab_alloc_factor = 1.044274
2024-06-04 01:01:46.797 [68160] main/104/interactive I> mapping 134217728 bytes for vinyl tuple arena...
2024-06-04 01:01:46.797 [68160] main/104/interactive/box.upgrade I> Recovering snapshot with schema version 3.1.0
2024-06-04 01:01:46.798 [68160] main/104/interactive I> update replication_synchro_quorum = 1
2024-06-04 01:01:46.798 [68160] main/104/interactive I> instance uuid 7411d451-49e1-4373-9fed-0a2c2a7b10a8
2024-06-04 01:01:46.799 [68160] main/104/interactive I> instance vclock {1: 1069}
2024-06-04 01:01:46.800 [68160] main/104/interactive I> tx_binary: bound to [::1]:3302
2024-06-04 01:01:46.800 [68160] main/104/interactive I> connecting to 2 replicas
2024-06-04 01:01:46.801 [68160] main/113/applier/replicator@localhost:3302 I> remote master 7411d451-49e1-4373-9fed-0a2c2a7b10a8 at [::1]:3302 running Tarantool 3.1.0
2024-06-04 01:01:46.801 [68160] main/112/applier/replicator@localhost:3301 I> remote master 33425648-d2aa-4911-9c90-dd6ec549d048 at [::1]:3301 running Tarantool 3.1.0
2024-06-04 01:01:46.803 [68160] main/104/interactive I> connected to 2 replicas
2024-06-04 01:01:46.803 [68160] main/104/interactive I> recovery start
2024-06-04 01:01:46.803 [68160] main/104/interactive I> recovering from `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/var/lib/storage-001-b/00000000000000000064.snap'
2024-06-04 01:01:46.804 [68160] main/104/interactive I> replicaset name: storage-001
2024-06-04 01:01:46.804 [68160] main/104/interactive I> replicaset uuid c903494a-bc47-40f2-9266-58472b3f5734
2024-06-04 01:01:46.821 [68160] main/104/interactive I> assigned id 1 to replica 33425648-d2aa-4911-9c90-dd6ec549d048
2024-06-04 01:01:46.821 [68160] main/104/interactive I> update replication_synchro_quorum = 1
2024-06-04 01:01:46.821 [68160] main/104/interactive I> assigned name storage-001-a to replica 33425648-d2aa-4911-9c90-dd6ec549d048
2024-06-04 01:01:46.821 [68160] main/104/interactive I> assigned id 2 to replica 7411d451-49e1-4373-9fed-0a2c2a7b10a8
2024-06-04 01:01:46.821 [68160] main/104/interactive I> update replication_synchro_quorum = 2
2024-06-04 01:01:46.821 [68160] main/104/interactive I> RAFT: fencing paused
2024-06-04 01:01:46.821 [68160] main/104/interactive I> assigned name storage-001-b to replica 7411d451-49e1-4373-9fed-0a2c2a7b10a8
2024-06-04 01:01:46.821 [68160] main/104/interactive I> recover from `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/var/lib/storage-001-b/00000000000000000064.xlog'
2024-06-04 01:01:46.822 [68160] main/104/interactive I> done `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/var/lib/storage-001-b/00000000000000000064.xlog'
2024-06-04 01:01:46.822 [68160] main/104/interactive I> recover from `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/var/lib/storage-001-b/00000000000000001066.xlog'
2024-06-04 01:01:46.822 [68160] main/104/interactive I> done `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/var/lib/storage-001-b/00000000000000001066.xlog'
2024-06-04 01:01:46.822 [68160] main/104/interactive I> recover from `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/var/lib/storage-001-b/00000000000000001068.xlog'
2024-06-04 01:01:46.822 [68160] main/104/interactive I> done `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/var/lib/storage-001-b/00000000000000001068.xlog'
2024-06-04 01:01:46.822 [68160] main/104/interactive I> recover from `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/var/lib/storage-001-b/00000000000000001069.xlog'
2024-06-04 01:01:46.822 [68160] main/104/interactive I> done `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/var/lib/storage-001-b/00000000000000001069.xlog'
2024-06-04 01:01:46.823 [68160] main/104/interactive I> Building secondary indexes in space '_bucket'...
2024-06-04 01:01:46.823 [68160] main/104/interactive I> Adding 500 keys to TREE index 'status' ...
2024-06-04 01:01:46.823 [68160] main/104/interactive I> Space '_bucket': done
2024-06-04 01:01:46.823 [68160] main/104/interactive I> Building secondary indexes in space 'messages'...
2024-06-04 01:01:46.823 [68160] main/104/interactive I> Adding 5 keys to TREE index 'bucket_id' ...
2024-06-04 01:01:46.823 [68160] main/104/interactive I> Adding 5 keys to TREE index 'dialog_hash' ...
2024-06-04 01:01:46.823 [68160] main/104/interactive I> Space 'messages': done
2024-06-04 01:01:46.823 [68160] main/104/interactive I> ready to accept requests
2024-06-04 01:01:46.823 [68160] main/104/interactive I> synchronizing with 2 replicas
2024-06-04 01:01:46.823 [68160] main/104/interactive C> failed to synchronize with 1 out of 2 replicas
2024-06-04 01:01:46.823 [68160] main/104/interactive I> entering orphan mode
2024-06-04 01:01:46.823 [68160] main/104/interactive/box.load_cfg I> set 'instance_name' configuration option to "storage-001-b"
2024-06-04 01:01:46.823 [68160] main/104/interactive/box.load_cfg I> set 'custom_proc_title' configuration option to "tarantool - storage-001-b"
2024-06-04 01:01:46.823 [68160] main/104/interactive/box.load_cfg I> set 'log_nonblock' configuration option to false
2024-06-04 01:01:46.823 [68160] main/104/interactive/box.load_cfg I> set 'replication' configuration option to ["replicator@localhost:3301","replicator@localhost:3302"]
2024-06-04 01:01:46.823 [68160] main/104/interactive/box.load_cfg I> set 'replicaset_name' configuration option to "storage-001"
2024-06-04 01:01:46.823 [68160] main/104/interactive/box.load_cfg I> set 'listen' configuration option to [{"uri":"localhost:3302"}]
2024-06-04 01:01:46.823 [68160] main/107/checkpoint_daemon I> scheduled next checkpoint for Tue Jun  4 02:23:06 2024
2024-06-04 01:01:46.823 [68160] main/112/applier/replicator@localhost:3301 I> failed to authenticate
2024-06-04 01:01:46.823 [68160] main/112/applier/replicator@localhost:3301 box.cc:4283 E> ER_LOADING: Instance bootstrap hasn't finished yet
2024-06-04 01:01:46.823 [68160] main/112/applier/replicator@localhost:3301 I> will retry every 1.00 second
2024-06-04 01:01:46.823 [68160] main/104/interactive/box.load_cfg I> set 'metrics' configuration option to {"labels":{"alias":"storage-001-b"},"include":["all"],"exclude":[]}
2024-06-04 01:01:46.823 [68160] main/104/interactive/box.load_cfg I> set 'read_only' configuration option to true
2024-06-04 01:01:46.841 [68160] main/119/console/unix/: sio.c:315 !> getpeername: Invalid argument
2024-06-04 01:01:46.842 [68160] main/104/interactive I> update replication_synchro_quorum = 2
2024-06-04 01:01:46.843 [68160] main/107/checkpoint_daemon I> scheduled next checkpoint for Tue Jun  4 02:16:19 2024
2024-06-04 01:01:46.877 [68160] main/104/interactive/tarantool.config I> sharding: apply storage config
2024-06-04 01:01:46.877 [68160] main/104/interactive/vshard.storage I> Starting configuration of replica storage-001-b
2024-06-04 01:01:46.877 [68160] main/104/interactive/vshard.storage I> Box configuration was skipped due to the 'manual' box_cfg_mode
2024-06-04 01:01:46.878 [68160] main/124/vshard.state_watch/vshard.util I> instance_watch_f has been started
2024-06-04 01:01:46.878 [68160] main/126/vshard.conn_man/vshard.util I> conn_manager_f has been started
2024-06-04 01:01:46.884 [68160] main I> entering the event loop
2024-06-04 01:01:46.891 [68160] main/111/main I> subscribed replica 33425648-d2aa-4911-9c90-dd6ec549d048 at fd 31, aka [::1]:3302, peer of [::1]:59477
2024-06-04 01:01:46.891 [68160] main/111/main I> remote vclock {1: 1069} local vclock {1: 1069}
2024-06-04 01:01:46.892 [68160] main/106/gc I> wal/engine cleanup is resumed
2024-06-04 01:01:46.892 [68160] relay/[::1]:59477/101/main I> recover from `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/var/lib/storage-001-b/00000000000000001069.xlog'
2024-06-04 01:01:47.825 [68160] main/112/applier/replicator@localhost:3301 I> authenticated
2024-06-04 01:01:47.825 [68160] main/112/applier/replicator@localhost:3301 I> subscribed
2024-06-04 01:01:47.825 [68160] main/112/applier/replicator@localhost:3301 I> remote vclock {1: 1069} local vclock {1: 1069}
2024-06-04 01:01:47.826 [68160] main/112/applier/replicator@localhost:3301 I> RAFT: message {term: 1, state: follower} from 1
2024-06-04 01:01:47.826 [68160] main/112/applier/replicator@localhost:3301 I> leaving orphan mode
2024-06-04 01:03:16.332 [68160] applier_1/103/writer/replicator@localhost:3301 I> fiber `writer/replicator@localhost:3301' has been cancelled
2024-06-04 01:03:16.332 [68160] applier_1/103/writer/replicator@localhost:3301 I> fiber `writer/replicator@localhost:3301': exiting
2024-06-04 01:03:16.332 [68160] main/112/applier/replicator@localhost:3301 I> can't read row
2024-06-04 01:03:16.332 [68160] main/112/applier/replicator@localhost:3301 coio.c:353 E> SocketError: unexpected EOF when reading from socket, called on fd 28, aka [::1]:59498, peer of [::1]:3301: Broken pipe
2024-06-04 01:03:16.332 [68160] main/112/applier/replicator@localhost:3301 I> will retry every 1.00 second
2024-06-04 01:03:16.334 [68160] relay/[::1]:59477/101/main coio.c:353 E> SocketError: unexpected EOF when reading from socket, called on fd 31, aka [::1]:3302, peer of [::1]:59477: Broken pipe
2024-06-04 01:03:16.334 [68160] relay/[::1]:59477/101/main I> exiting the relay loop
2024-06-04 01:03:16.434 [68160] main C> got signal 2 - Interrupt: 2
2024-06-04 01:03:16.434 [68160] main/130/iproto.shutdown I> tx_binary: stopped
2024-06-04 01:03:16.436 [68160] main/103/on_shutdown I> leaving orphan mode
Watchdog 2024/06/04 01:03:16 (INFO): the Instance has shutdown.
Watchdog 2024/06/04 01:03:35 (INFO): using "/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/config.yaml" cluster config for instance "storage-001-b"
started
2024-06-04 01:03:35.265 [68362] main/104/interactive I> Tarantool 3.1.0-0-g96f6d88 Darwin-x86_64-Release
2024-06-04 01:03:35.266 [68362] main/104/interactive I> log level 5 (INFO)
2024-06-04 01:03:35.266 [68362] main/104/interactive I> wal/engine cleanup is paused
2024-06-04 01:03:35.266 [68362] main/104/interactive I> mapping 268435456 bytes for memtx tuple arena...
2024-06-04 01:03:35.266 [68362] main/104/interactive I> Actual slab_alloc_factor calculated on the basis of desired slab_alloc_factor = 1.044274
2024-06-04 01:03:35.266 [68362] main/104/interactive I> mapping 134217728 bytes for vinyl tuple arena...
2024-06-04 01:03:35.267 [68362] main/104/interactive/box.upgrade I> Recovering snapshot with schema version 3.1.0
2024-06-04 01:03:35.268 [68362] main/104/interactive I> update replication_synchro_quorum = 1
2024-06-04 01:03:35.268 [68362] main/104/interactive I> instance uuid 7411d451-49e1-4373-9fed-0a2c2a7b10a8
2024-06-04 01:03:35.268 [68362] main/104/interactive I> instance vclock {1: 1069}
2024-06-04 01:03:35.269 [68362] main/104/interactive I> tx_binary: bound to [::1]:3302
2024-06-04 01:03:35.270 [68362] main/104/interactive I> connecting to 2 replicas
2024-06-04 01:03:35.271 [68362] main/113/applier/replicator@localhost:3302 I> remote master 7411d451-49e1-4373-9fed-0a2c2a7b10a8 at [::1]:3302 running Tarantool 3.1.0
2024-06-04 01:03:35.271 [68362] main/112/applier/replicator@localhost:3301 I> remote master 33425648-d2aa-4911-9c90-dd6ec549d048 at [::1]:3301 running Tarantool 3.1.0
2024-06-04 01:03:35.273 [68362] main/104/interactive I> connected to 2 replicas
2024-06-04 01:03:35.273 [68362] main/104/interactive I> recovery start
2024-06-04 01:03:35.273 [68362] main/104/interactive I> recovering from `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/var/lib/storage-001-b/00000000000000000064.snap'
2024-06-04 01:03:35.273 [68362] main/104/interactive I> replicaset name: storage-001
2024-06-04 01:03:35.273 [68362] main/104/interactive I> replicaset uuid c903494a-bc47-40f2-9266-58472b3f5734
2024-06-04 01:03:35.290 [68362] main/104/interactive I> assigned id 1 to replica 33425648-d2aa-4911-9c90-dd6ec549d048
2024-06-04 01:03:35.290 [68362] main/104/interactive I> update replication_synchro_quorum = 1
2024-06-04 01:03:35.290 [68362] main/104/interactive I> assigned name storage-001-a to replica 33425648-d2aa-4911-9c90-dd6ec549d048
2024-06-04 01:03:35.290 [68362] main/104/interactive I> assigned id 2 to replica 7411d451-49e1-4373-9fed-0a2c2a7b10a8
2024-06-04 01:03:35.290 [68362] main/104/interactive I> update replication_synchro_quorum = 2
2024-06-04 01:03:35.290 [68362] main/104/interactive I> RAFT: fencing paused
2024-06-04 01:03:35.290 [68362] main/104/interactive I> assigned name storage-001-b to replica 7411d451-49e1-4373-9fed-0a2c2a7b10a8
2024-06-04 01:03:35.290 [68362] main/104/interactive I> recover from `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/var/lib/storage-001-b/00000000000000000064.xlog'
2024-06-04 01:03:35.291 [68362] main/104/interactive I> done `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/var/lib/storage-001-b/00000000000000000064.xlog'
2024-06-04 01:03:35.291 [68362] main/104/interactive I> recover from `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/var/lib/storage-001-b/00000000000000001066.xlog'
2024-06-04 01:03:35.291 [68362] main/104/interactive I> done `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/var/lib/storage-001-b/00000000000000001066.xlog'
2024-06-04 01:03:35.291 [68362] main/104/interactive I> recover from `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/var/lib/storage-001-b/00000000000000001068.xlog'
2024-06-04 01:03:35.291 [68362] main/104/interactive I> done `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/var/lib/storage-001-b/00000000000000001068.xlog'
2024-06-04 01:03:35.291 [68362] main/104/interactive I> recover from `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/var/lib/storage-001-b/00000000000000001069.xlog'
2024-06-04 01:03:35.291 [68362] main/104/interactive I> done `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/var/lib/storage-001-b/00000000000000001069.xlog'
2024-06-04 01:03:35.291 [68362] main/104/interactive I> Building secondary indexes in space '_bucket'...
2024-06-04 01:03:35.291 [68362] main/104/interactive I> Adding 500 keys to TREE index 'status' ...
2024-06-04 01:03:35.291 [68362] main/104/interactive I> Space '_bucket': done
2024-06-04 01:03:35.291 [68362] main/104/interactive I> Building secondary indexes in space 'messages'...
2024-06-04 01:03:35.291 [68362] main/104/interactive I> Adding 5 keys to TREE index 'bucket_id' ...
2024-06-04 01:03:35.291 [68362] main/104/interactive I> Adding 5 keys to TREE index 'dialog_hash' ...
2024-06-04 01:03:35.291 [68362] main/104/interactive I> Space 'messages': done
2024-06-04 01:03:35.292 [68362] main/104/interactive I> ready to accept requests
2024-06-04 01:03:35.292 [68362] main/104/interactive I> synchronizing with 2 replicas
2024-06-04 01:03:35.292 [68362] main/104/interactive C> failed to synchronize with 1 out of 2 replicas
2024-06-04 01:03:35.292 [68362] main/104/interactive I> entering orphan mode
2024-06-04 01:03:35.292 [68362] main/104/interactive/box.load_cfg I> set 'instance_name' configuration option to "storage-001-b"
2024-06-04 01:03:35.292 [68362] main/104/interactive/box.load_cfg I> set 'custom_proc_title' configuration option to "tarantool - storage-001-b"
2024-06-04 01:03:35.292 [68362] main/104/interactive/box.load_cfg I> set 'log_nonblock' configuration option to false
2024-06-04 01:03:35.292 [68362] main/104/interactive/box.load_cfg I> set 'replication' configuration option to ["replicator@localhost:3301","replicator@localhost:3302"]
2024-06-04 01:03:35.292 [68362] main/104/interactive/box.load_cfg I> set 'replicaset_name' configuration option to "storage-001"
2024-06-04 01:03:35.292 [68362] main/104/interactive/box.load_cfg I> set 'listen' configuration option to [{"uri":"localhost:3302"}]
2024-06-04 01:03:35.292 [68362] main/107/checkpoint_daemon I> scheduled next checkpoint for Tue Jun  4 02:47:03 2024
2024-06-04 01:03:35.292 [68362] main/104/interactive/box.load_cfg I> set 'metrics' configuration option to {"labels":{"alias":"storage-001-b"},"include":["all"],"exclude":[]}
2024-06-04 01:03:35.292 [68362] main/104/interactive/box.load_cfg I> set 'read_only' configuration option to true
2024-06-04 01:03:35.293 [68362] main/112/applier/replicator@localhost:3301 I> authenticated
2024-06-04 01:03:35.307 [68362] main/112/applier/replicator@localhost:3301 I> subscribed
2024-06-04 01:03:35.307 [68362] main/112/applier/replicator@localhost:3301 I> remote vclock {1: 1069} local vclock {1: 1069}
2024-06-04 01:03:35.307 [68362] main/111/main I> subscribed replica 33425648-d2aa-4911-9c90-dd6ec549d048 at fd 29, aka [::1]:3302, peer of [::1]:59656
2024-06-04 01:03:35.307 [68362] main/111/main I> remote vclock {1: 1069} local vclock {1: 1069}
2024-06-04 01:03:35.308 [68362] main/106/gc I> wal/engine cleanup is resumed
2024-06-04 01:03:35.308 [68362] main/112/applier/replicator@localhost:3301 I> RAFT: message {term: 1, state: follower} from 1
2024-06-04 01:03:35.308 [68362] main/112/applier/replicator@localhost:3301 I> leaving orphan mode
2024-06-04 01:03:35.308 [68362] relay/[::1]:59656/101/main I> recover from `/Users/r.sarvarov/projects/hlsoc/microservices/dialogs/var/lib/storage-001-b/00000000000000001069.xlog'
2024-06-04 01:03:35.310 [68362] main/120/console/unix/: sio.c:315 !> getpeername: Invalid argument
2024-06-04 01:03:35.310 [68362] main/104/interactive I> update replication_synchro_quorum = 2
2024-06-04 01:03:35.311 [68362] main/107/checkpoint_daemon I> scheduled next checkpoint for Tue Jun  4 02:18:06 2024
2024-06-04 01:03:35.346 [68362] main/104/interactive/tarantool.config I> sharding: apply storage config
2024-06-04 01:03:35.346 [68362] main/104/interactive/vshard.storage I> Starting configuration of replica storage-001-b
2024-06-04 01:03:35.346 [68362] main/104/interactive/vshard.storage I> Box configuration was skipped due to the 'manual' box_cfg_mode
2024-06-04 01:03:35.346 [68362] main/125/vshard.state_watch/vshard.util I> instance_watch_f has been started
2024-06-04 01:03:35.346 [68362] main/127/vshard.conn_man/vshard.util I> conn_manager_f has been started
2024-06-04 01:03:35.354 [68362] main I> entering the event loop
